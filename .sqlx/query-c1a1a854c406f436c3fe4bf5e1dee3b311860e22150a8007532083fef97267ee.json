{
  "db_name": "PostgreSQL",
  "query": "\n        WITH picked AS (\n            SELECT task_id\n            FROM internal.tasks\n            WHERE\n                task_type = ANY($1) AND\n                wake_at   < NOW() AND\n                heartbeat < NOW() - $2::INTERVAL\n            ORDER BY wake_at DESC\n            LIMIT $3\n            FOR UPDATE SKIP LOCKED\n        )\n        UPDATE internal.tasks\n        SET heartbeat = NOW()\n        WHERE task_id in (SELECT task_id FROM picked)\n        RETURNING\n            task_id as \"id: models::Id\",\n            task_type as \"type_: TaskType\",\n            parent_id as \"parent_id: models::Id\",\n            inbox as \"inbox: Vec<SqlJson<(models::Id, Option<BoxedRaw>)>>\",\n            inner_state as \"state: SqlJson<BoxedRaw>\",\n            heartbeat::TEXT as \"last_heartbeat!\";\n        ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "id: models::Id",
        "type_info": "Macaddr8"
      },
      {
        "ordinal": 1,
        "name": "type_: TaskType",
        "type_info": "Int2"
      },
      {
        "ordinal": 2,
        "name": "parent_id: models::Id",
        "type_info": "Macaddr8"
      },
      {
        "ordinal": 3,
        "name": "inbox: Vec<SqlJson<(models::Id, Option<BoxedRaw>)>>",
        "type_info": "JsonArray"
      },
      {
        "ordinal": 4,
        "name": "state: SqlJson<BoxedRaw>",
        "type_info": "Json"
      },
      {
        "ordinal": 5,
        "name": "last_heartbeat!",
        "type_info": "Text"
      }
    ],
    "parameters": {
      "Left": [
        "Int2Array",
        "Interval",
        "Int8"
      ]
    },
    "nullable": [
      false,
      false,
      true,
      true,
      true,
      null
    ]
  },
  "hash": "c1a1a854c406f436c3fe4bf5e1dee3b311860e22150a8007532083fef97267ee"
}

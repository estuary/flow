---
source: crates/validation/tests/transition_tests.rs
expression: outcome
---
Outcome {
    built_captures: [
        BuiltCapture {
            capture: the/capture,
            scope: test://example/catalog.yaml#/captures/the~1capture,
            control_id: "0000000000000000",
            data_plane_id: "1d1d1d1d1d1d1d1d",
            expect_pub_id: "0000000000000000",
            expect_build_id: "0000000000000000",
            model: {
              "endpoint": {
                "connector": {
                  "image": "an/image",
                  "config": {"a":"config"}
                }
              },
              "bindings": [
                {
                  "resource": {"_meta":{"path":["capture","path"]},"table":"foo"},
                  "target": "the/collection"
                }
              ]
            },
            model_fixes: [],
            validated: Validated {
                bindings: [
                    Binding {
                        resource_path: [
                            "capture",
                            "path",
                        ],
                    },
                ],
            },
            spec: CaptureSpec {
                name: "the/capture",
                connector_type: Image,
                config_json: "{\"image\":\"an/image\",\"config\":{\"a\":\"config\"}}",
                bindings: [
                    Binding {
                        resource_config_json: "{\"table\":\"foo\"}",
                        resource_path: [
                            "capture",
                            "path",
                        ],
                        collection: Some(
                            CollectionSpec {
                                name: "the/collection",
                                write_schema_json: "{\"$id\":\"test://example/catalog.yaml?ptr=/collections/the~1collection/schema\",\"properties\":{\"f_one\":{\"type\":\"integer\"},\"f_two\":{\"type\":\"string\"},\"f_x\":false},\"required\":[\"f_one\",\"f_two\"],\"type\":\"object\"}",
                                read_schema_json: "",
                                key: [
                                    "/f_one",
                                ],
                                uuid_ptr: "/_meta/uuid",
                                partition_fields: [],
                                projections: [
                                    Projection {
                                        ptr: "/f_one",
                                        field: "F1",
                                        explicit: true,
                                        is_partition_key: false,
                                        is_primary_key: true,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "integer",
                                                ],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: Some(
                                                    Numeric {
                                                        has_minimum: false,
                                                        minimum: 0.0,
                                                        has_maximum: false,
                                                        maximum: 0.0,
                                                    },
                                                ),
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_two",
                                        field: "F2",
                                        explicit: true,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "string",
                                                ],
                                                string: Some(
                                                    String {
                                                        content_type: "",
                                                        format: "",
                                                        content_encoding: "",
                                                        max_length: 0,
                                                    },
                                                ),
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/_meta/flow_truncated",
                                        field: "_meta/flow_truncated",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "boolean",
                                                ],
                                                string: None,
                                                title: "Flow truncation indicator",
                                                description: "Indicates whether any of the materialized values for this row have been truncated to make them fit inside the limitations of the destination system.",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_one",
                                        field: "f_one",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: true,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "integer",
                                                ],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: Some(
                                                    Numeric {
                                                        has_minimum: false,
                                                        minimum: 0.0,
                                                        has_maximum: false,
                                                        maximum: 0.0,
                                                    },
                                                ),
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_two",
                                        field: "f_two",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "string",
                                                ],
                                                string: Some(
                                                    String {
                                                        content_type: "",
                                                        format: "",
                                                        content_encoding: "",
                                                        max_length: 0,
                                                    },
                                                ),
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_x",
                                        field: "f_x",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Cannot,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "",
                                        field: "flow_document",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "object",
                                                ],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/_meta/uuid",
                                        field: "flow_published_at",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "string",
                                                ],
                                                string: Some(
                                                    String {
                                                        content_type: "",
                                                        format: "date-time",
                                                        content_encoding: "uuid",
                                                        max_length: 0,
                                                    },
                                                ),
                                                title: "Flow Publication Time",
                                                description: "Flow publication date-time of this document",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                ],
                                ack_template_json: "{\"_meta\":{\"ack\":true,\"uuid\":\"DocUUIDPlaceholder-329Bb50aa48EAa9ef\"}}",
                                partition_template: Some(
                                    JournalSpec {
                                        name: "the/collection/2020202020202020",
                                        replication: 3,
                                        labels: Some(
                                            LabelSet {
                                                labels: [
                                                    Label {
                                                        name: "app.gazette.dev/managed-by",
                                                        value: "estuary.dev/flow",
                                                        prefix: false,
                                                    },
                                                    Label {
                                                        name: "content-type",
                                                        value: "application/x-ndjson",
                                                        prefix: false,
                                                    },
                                                    Label {
                                                        name: "estuary.dev/build",
                                                        value: "2121212121212121",
                                                        prefix: false,
                                                    },
                                                    Label {
                                                        name: "estuary.dev/collection",
                                                        value: "the/collection",
                                                        prefix: false,
                                                    },
                                                ],
                                            },
                                        ),
                                        fragment: Some(
                                            Fragment {
                                                length: 536870912,
                                                compression_codec: Gzip,
                                                stores: [
                                                    "s3://a-bucket/",
                                                ],
                                                refresh_interval: Some(
                                                    Duration {
                                                        seconds: 300,
                                                        nanos: 0,
                                                    },
                                                ),
                                                retention: None,
                                                flush_interval: Some(
                                                    Duration {
                                                        seconds: 86400,
                                                        nanos: 0,
                                                    },
                                                ),
                                                path_postfix_template: "utc_date={{.Spool.FirstAppendTime.Format \"2006-01-02\"}}/utc_hour={{.Spool.FirstAppendTime.Format \"15\"}}",
                                            },
                                        ),
                                        flags: 4,
                                        max_append_rate: 4194304,
                                        suspend: None,
                                    },
                                ),
                                derivation: None,
                            },
                        ),
                        backfill: 0,
                        state_key: "capture%2Fpath",
                    },
                ],
                interval_seconds: 300,
                shard_template: Some(
                    ShardSpec {
                        id: "capture/the/capture/2020202020202020",
                        sources: [],
                        recovery_log_prefix: "recovery",
                        hint_prefix: "/estuary/flow/hints",
                        hint_backups: 2,
                        max_txn_duration: Some(
                            Duration {
                                seconds: 1,
                                nanos: 0,
                            },
                        ),
                        min_txn_duration: Some(
                            Duration {
                                seconds: 0,
                                nanos: 0,
                            },
                        ),
                        disable: false,
                        hot_standbys: 0,
                        labels: Some(
                            LabelSet {
                                labels: [
                                    Label {
                                        name: "app.gazette.dev/managed-by",
                                        value: "estuary.dev/flow",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/build",
                                        value: "2121212121212121",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/log-level",
                                        value: "info",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-name",
                                        value: "the/capture",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-type",
                                        value: "capture",
                                        prefix: false,
                                    },
                                ],
                            },
                        ),
                        disable_wait_for_ack: false,
                        ring_buffer_size: 65536,
                        read_channel_size: 4096,
                    },
                ),
                recovery_log_template: Some(
                    JournalSpec {
                        name: "recovery/capture/the/capture/2020202020202020",
                        replication: 3,
                        labels: Some(
                            LabelSet {
                                labels: [
                                    Label {
                                        name: "app.gazette.dev/managed-by",
                                        value: "estuary.dev/flow",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "content-type",
                                        value: "application/x-gazette-recoverylog",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/build",
                                        value: "2121212121212121",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-name",
                                        value: "the/capture",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-type",
                                        value: "capture",
                                        prefix: false,
                                    },
                                ],
                            },
                        ),
                        fragment: Some(
                            Fragment {
                                length: 268435456,
                                compression_codec: Snappy,
                                stores: [
                                    "s3://a-bucket/",
                                ],
                                refresh_interval: Some(
                                    Duration {
                                        seconds: 300,
                                        nanos: 0,
                                    },
                                ),
                                retention: None,
                                flush_interval: Some(
                                    Duration {
                                        seconds: 172800,
                                        nanos: 0,
                                    },
                                ),
                                path_postfix_template: "",
                            },
                        ),
                        flags: 4,
                        max_append_rate: 4194304,
                        suspend: None,
                    },
                ),
                network_ports: [],
                inactive_bindings: [],
            },
            previous_spec: NULL,
            is_touch: 0,
            dependency_hash: 5b38dc32c776e2b2,
        },
    ],
    built_collections: [
        BuiltCollection {
            collection: the/collection,
            scope: test://example/catalog.yaml#/collections/the~1collection,
            control_id: "0000000000000000",
            data_plane_id: "1d1d1d1d1d1d1d1d",
            expect_pub_id: "0000000000000000",
            expect_build_id: "0000000000000000",
            model: {
              "schema": {"$id":"test://example/catalog.yaml?ptr=/collections/the~1collection/schema","properties":{"f_one":{"type":"integer"},"f_two":{"type":"string"},"f_x":false},"required":["f_one","f_two"],"type":"object"},
              "key": [
                "/f_one"
              ],
              "projections": {
                "F1": "/f_one",
                "F2": "/f_two"
              }
            },
            model_fixes: [],
            validated: NULL,
            spec: CollectionSpec {
                name: "the/collection",
                write_schema_json: "{\"$id\":\"test://example/catalog.yaml?ptr=/collections/the~1collection/schema\",\"properties\":{\"f_one\":{\"type\":\"integer\"},\"f_two\":{\"type\":\"string\"},\"f_x\":false},\"required\":[\"f_one\",\"f_two\"],\"type\":\"object\"}",
                read_schema_json: "",
                key: [
                    "/f_one",
                ],
                uuid_ptr: "/_meta/uuid",
                partition_fields: [],
                projections: [
                    Projection {
                        ptr: "/f_one",
                        field: "F1",
                        explicit: true,
                        is_partition_key: false,
                        is_primary_key: true,
                        inference: Some(
                            Inference {
                                types: [
                                    "integer",
                                ],
                                string: None,
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: Some(
                                    Numeric {
                                        has_minimum: false,
                                        minimum: 0.0,
                                        has_maximum: false,
                                        maximum: 0.0,
                                    },
                                ),
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/f_two",
                        field: "F2",
                        explicit: true,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "string",
                                ],
                                string: Some(
                                    String {
                                        content_type: "",
                                        format: "",
                                        content_encoding: "",
                                        max_length: 0,
                                    },
                                ),
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/_meta/flow_truncated",
                        field: "_meta/flow_truncated",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "boolean",
                                ],
                                string: None,
                                title: "Flow truncation indicator",
                                description: "Indicates whether any of the materialized values for this row have been truncated to make them fit inside the limitations of the destination system.",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/f_one",
                        field: "f_one",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: true,
                        inference: Some(
                            Inference {
                                types: [
                                    "integer",
                                ],
                                string: None,
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: Some(
                                    Numeric {
                                        has_minimum: false,
                                        minimum: 0.0,
                                        has_maximum: false,
                                        maximum: 0.0,
                                    },
                                ),
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/f_two",
                        field: "f_two",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "string",
                                ],
                                string: Some(
                                    String {
                                        content_type: "",
                                        format: "",
                                        content_encoding: "",
                                        max_length: 0,
                                    },
                                ),
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/f_x",
                        field: "f_x",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [],
                                string: None,
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Cannot,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "",
                        field: "flow_document",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "object",
                                ],
                                string: None,
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/_meta/uuid",
                        field: "flow_published_at",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "string",
                                ],
                                string: Some(
                                    String {
                                        content_type: "",
                                        format: "date-time",
                                        content_encoding: "uuid",
                                        max_length: 0,
                                    },
                                ),
                                title: "Flow Publication Time",
                                description: "Flow publication date-time of this document",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                ],
                ack_template_json: "{\"_meta\":{\"ack\":true,\"uuid\":\"DocUUIDPlaceholder-329Bb50aa48EAa9ef\"}}",
                partition_template: Some(
                    JournalSpec {
                        name: "the/collection/2020202020202020",
                        replication: 3,
                        labels: Some(
                            LabelSet {
                                labels: [
                                    Label {
                                        name: "app.gazette.dev/managed-by",
                                        value: "estuary.dev/flow",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "content-type",
                                        value: "application/x-ndjson",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/build",
                                        value: "2121212121212121",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/collection",
                                        value: "the/collection",
                                        prefix: false,
                                    },
                                ],
                            },
                        ),
                        fragment: Some(
                            Fragment {
                                length: 536870912,
                                compression_codec: Gzip,
                                stores: [
                                    "s3://a-bucket/",
                                ],
                                refresh_interval: Some(
                                    Duration {
                                        seconds: 300,
                                        nanos: 0,
                                    },
                                ),
                                retention: None,
                                flush_interval: Some(
                                    Duration {
                                        seconds: 86400,
                                        nanos: 0,
                                    },
                                ),
                                path_postfix_template: "utc_date={{.Spool.FirstAppendTime.Format \"2006-01-02\"}}/utc_hour={{.Spool.FirstAppendTime.Format \"15\"}}",
                            },
                        ),
                        flags: 4,
                        max_append_rate: 4194304,
                        suspend: None,
                    },
                ),
                derivation: None,
            },
            previous_spec: NULL,
            is_touch: 0,
            dependency_hash: NULL,
        },
        BuiltCollection {
            collection: the/derivation,
            scope: test://example/catalog.yaml#/collections/the~1derivation,
            control_id: "0000000000000000",
            data_plane_id: "1d1d1d1d1d1d1d1d",
            expect_pub_id: "0000000000000000",
            expect_build_id: "0000000000000000",
            model: {
              "schema": {"$id":"test://example/catalog.yaml?ptr=/collections/the~1derivation/schema","properties":{"d_one":{"type":"integer"},"d_two":{"type":"string"}},"required":["d_one","d_two"],"type":"object"},
              "key": [
                "/d_one"
              ],
              "derive": {
                "using": {
                  "sqlite": {}
                },
                "transforms": [
                  {
                    "name": "fromCollection",
                    "source": {
                      "name": "the/collection"
                    },
                    "shuffle": {
                      "key": [
                        "/f_two"
                      ]
                    },
                    "lambda": "select 123 as d_one, 'hello' as d_two;\n"
                  }
                ]
              }
            },
            model_fixes: [],
            validated: Validated {
                transforms: [
                    Transform {
                        read_only: true,
                    },
                ],
                generated_files: {},
            },
            spec: CollectionSpec {
                name: "the/derivation",
                write_schema_json: "{\"$id\":\"test://example/catalog.yaml?ptr=/collections/the~1derivation/schema\",\"properties\":{\"d_one\":{\"type\":\"integer\"},\"d_two\":{\"type\":\"string\"}},\"required\":[\"d_one\",\"d_two\"],\"type\":\"object\"}",
                read_schema_json: "",
                key: [
                    "/d_one",
                ],
                uuid_ptr: "/_meta/uuid",
                partition_fields: [],
                projections: [
                    Projection {
                        ptr: "/_meta/flow_truncated",
                        field: "_meta/flow_truncated",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "boolean",
                                ],
                                string: None,
                                title: "Flow truncation indicator",
                                description: "Indicates whether any of the materialized values for this row have been truncated to make them fit inside the limitations of the destination system.",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/d_one",
                        field: "d_one",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: true,
                        inference: Some(
                            Inference {
                                types: [
                                    "integer",
                                ],
                                string: None,
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: Some(
                                    Numeric {
                                        has_minimum: false,
                                        minimum: 0.0,
                                        has_maximum: false,
                                        maximum: 0.0,
                                    },
                                ),
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/d_two",
                        field: "d_two",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "string",
                                ],
                                string: Some(
                                    String {
                                        content_type: "",
                                        format: "",
                                        content_encoding: "",
                                        max_length: 0,
                                    },
                                ),
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "",
                        field: "flow_document",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "object",
                                ],
                                string: None,
                                title: "",
                                description: "",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                    Projection {
                        ptr: "/_meta/uuid",
                        field: "flow_published_at",
                        explicit: false,
                        is_partition_key: false,
                        is_primary_key: false,
                        inference: Some(
                            Inference {
                                types: [
                                    "string",
                                ],
                                string: Some(
                                    String {
                                        content_type: "",
                                        format: "date-time",
                                        content_encoding: "uuid",
                                        max_length: 0,
                                    },
                                ),
                                title: "Flow Publication Time",
                                description: "Flow publication date-time of this document",
                                default_json: "",
                                secret: false,
                                exists: Must,
                                numeric: None,
                                array: None,
                            },
                        ),
                    },
                ],
                ack_template_json: "{\"_meta\":{\"ack\":true,\"uuid\":\"DocUUIDPlaceholder-329Bb50aa48EAa9ef\"}}",
                partition_template: Some(
                    JournalSpec {
                        name: "the/derivation/2020202020202020",
                        replication: 3,
                        labels: Some(
                            LabelSet {
                                labels: [
                                    Label {
                                        name: "app.gazette.dev/managed-by",
                                        value: "estuary.dev/flow",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "content-type",
                                        value: "application/x-ndjson",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/build",
                                        value: "2121212121212121",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/collection",
                                        value: "the/derivation",
                                        prefix: false,
                                    },
                                ],
                            },
                        ),
                        fragment: Some(
                            Fragment {
                                length: 536870912,
                                compression_codec: Gzip,
                                stores: [
                                    "s3://a-bucket/",
                                ],
                                refresh_interval: Some(
                                    Duration {
                                        seconds: 300,
                                        nanos: 0,
                                    },
                                ),
                                retention: None,
                                flush_interval: Some(
                                    Duration {
                                        seconds: 86400,
                                        nanos: 0,
                                    },
                                ),
                                path_postfix_template: "utc_date={{.Spool.FirstAppendTime.Format \"2006-01-02\"}}/utc_hour={{.Spool.FirstAppendTime.Format \"15\"}}",
                            },
                        ),
                        flags: 4,
                        max_append_rate: 4194304,
                        suspend: None,
                    },
                ),
                derivation: Some(
                    Derivation {
                        connector_type: Sqlite,
                        config_json: "{}",
                        transforms: [
                            Transform {
                                name: "fromCollection",
                                collection: Some(
                                    CollectionSpec {
                                        name: "the/collection",
                                        write_schema_json: "{\"$id\":\"test://example/catalog.yaml?ptr=/collections/the~1collection/schema\",\"properties\":{\"f_one\":{\"type\":\"integer\"},\"f_two\":{\"type\":\"string\"},\"f_x\":false},\"required\":[\"f_one\",\"f_two\"],\"type\":\"object\"}",
                                        read_schema_json: "",
                                        key: [
                                            "/f_one",
                                        ],
                                        uuid_ptr: "/_meta/uuid",
                                        partition_fields: [],
                                        projections: [
                                            Projection {
                                                ptr: "/f_one",
                                                field: "F1",
                                                explicit: true,
                                                is_partition_key: false,
                                                is_primary_key: true,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "integer",
                                                        ],
                                                        string: None,
                                                        title: "",
                                                        description: "",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: Some(
                                                            Numeric {
                                                                has_minimum: false,
                                                                minimum: 0.0,
                                                                has_maximum: false,
                                                                maximum: 0.0,
                                                            },
                                                        ),
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "/f_two",
                                                field: "F2",
                                                explicit: true,
                                                is_partition_key: false,
                                                is_primary_key: false,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "string",
                                                        ],
                                                        string: Some(
                                                            String {
                                                                content_type: "",
                                                                format: "",
                                                                content_encoding: "",
                                                                max_length: 0,
                                                            },
                                                        ),
                                                        title: "",
                                                        description: "",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: None,
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "/_meta/flow_truncated",
                                                field: "_meta/flow_truncated",
                                                explicit: false,
                                                is_partition_key: false,
                                                is_primary_key: false,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "boolean",
                                                        ],
                                                        string: None,
                                                        title: "Flow truncation indicator",
                                                        description: "Indicates whether any of the materialized values for this row have been truncated to make them fit inside the limitations of the destination system.",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: None,
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "/f_one",
                                                field: "f_one",
                                                explicit: false,
                                                is_partition_key: false,
                                                is_primary_key: true,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "integer",
                                                        ],
                                                        string: None,
                                                        title: "",
                                                        description: "",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: Some(
                                                            Numeric {
                                                                has_minimum: false,
                                                                minimum: 0.0,
                                                                has_maximum: false,
                                                                maximum: 0.0,
                                                            },
                                                        ),
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "/f_two",
                                                field: "f_two",
                                                explicit: false,
                                                is_partition_key: false,
                                                is_primary_key: false,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "string",
                                                        ],
                                                        string: Some(
                                                            String {
                                                                content_type: "",
                                                                format: "",
                                                                content_encoding: "",
                                                                max_length: 0,
                                                            },
                                                        ),
                                                        title: "",
                                                        description: "",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: None,
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "/f_x",
                                                field: "f_x",
                                                explicit: false,
                                                is_partition_key: false,
                                                is_primary_key: false,
                                                inference: Some(
                                                    Inference {
                                                        types: [],
                                                        string: None,
                                                        title: "",
                                                        description: "",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Cannot,
                                                        numeric: None,
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "",
                                                field: "flow_document",
                                                explicit: false,
                                                is_partition_key: false,
                                                is_primary_key: false,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "object",
                                                        ],
                                                        string: None,
                                                        title: "",
                                                        description: "",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: None,
                                                        array: None,
                                                    },
                                                ),
                                            },
                                            Projection {
                                                ptr: "/_meta/uuid",
                                                field: "flow_published_at",
                                                explicit: false,
                                                is_partition_key: false,
                                                is_primary_key: false,
                                                inference: Some(
                                                    Inference {
                                                        types: [
                                                            "string",
                                                        ],
                                                        string: Some(
                                                            String {
                                                                content_type: "",
                                                                format: "date-time",
                                                                content_encoding: "uuid",
                                                                max_length: 0,
                                                            },
                                                        ),
                                                        title: "Flow Publication Time",
                                                        description: "Flow publication date-time of this document",
                                                        default_json: "",
                                                        secret: false,
                                                        exists: Must,
                                                        numeric: None,
                                                        array: None,
                                                    },
                                                ),
                                            },
                                        ],
                                        ack_template_json: "{\"_meta\":{\"ack\":true,\"uuid\":\"DocUUIDPlaceholder-329Bb50aa48EAa9ef\"}}",
                                        partition_template: Some(
                                            JournalSpec {
                                                name: "the/collection/2020202020202020",
                                                replication: 3,
                                                labels: Some(
                                                    LabelSet {
                                                        labels: [
                                                            Label {
                                                                name: "app.gazette.dev/managed-by",
                                                                value: "estuary.dev/flow",
                                                                prefix: false,
                                                            },
                                                            Label {
                                                                name: "content-type",
                                                                value: "application/x-ndjson",
                                                                prefix: false,
                                                            },
                                                            Label {
                                                                name: "estuary.dev/build",
                                                                value: "2121212121212121",
                                                                prefix: false,
                                                            },
                                                            Label {
                                                                name: "estuary.dev/collection",
                                                                value: "the/collection",
                                                                prefix: false,
                                                            },
                                                        ],
                                                    },
                                                ),
                                                fragment: Some(
                                                    Fragment {
                                                        length: 536870912,
                                                        compression_codec: Gzip,
                                                        stores: [
                                                            "s3://a-bucket/",
                                                        ],
                                                        refresh_interval: Some(
                                                            Duration {
                                                                seconds: 300,
                                                                nanos: 0,
                                                            },
                                                        ),
                                                        retention: None,
                                                        flush_interval: Some(
                                                            Duration {
                                                                seconds: 86400,
                                                                nanos: 0,
                                                            },
                                                        ),
                                                        path_postfix_template: "utc_date={{.Spool.FirstAppendTime.Format \"2006-01-02\"}}/utc_hour={{.Spool.FirstAppendTime.Format \"15\"}}",
                                                    },
                                                ),
                                                flags: 4,
                                                max_append_rate: 4194304,
                                                suspend: None,
                                            },
                                        ),
                                        derivation: None,
                                    },
                                ),
                                partition_selector: Some(
                                    LabelSelector {
                                        include: Some(
                                            LabelSet {
                                                labels: [
                                                    Label {
                                                        name: "estuary.dev/collection",
                                                        value: "the/collection",
                                                        prefix: false,
                                                    },
                                                ],
                                            },
                                        ),
                                        exclude: Some(
                                            LabelSet {
                                                labels: [],
                                            },
                                        ),
                                    },
                                ),
                                priority: 0,
                                read_delay_seconds: 0,
                                shuffle_key: [
                                    "/f_two",
                                ],
                                shuffle_lambda_config_json: "",
                                lambda_config_json: "\"select 123 as d_one, 'hello' as d_two;\\n\"",
                                read_only: true,
                                journal_read_suffix: "derive/the/derivation/fromCollection",
                                not_before: None,
                                not_after: None,
                                backfill: 0,
                            },
                        ],
                        shuffle_key_types: [
                            String,
                        ],
                        shard_template: Some(
                            ShardSpec {
                                id: "derivation/the/derivation/2020202020202020",
                                sources: [],
                                recovery_log_prefix: "recovery",
                                hint_prefix: "/estuary/flow/hints",
                                hint_backups: 2,
                                max_txn_duration: Some(
                                    Duration {
                                        seconds: 1,
                                        nanos: 0,
                                    },
                                ),
                                min_txn_duration: Some(
                                    Duration {
                                        seconds: 0,
                                        nanos: 0,
                                    },
                                ),
                                disable: false,
                                hot_standbys: 0,
                                labels: Some(
                                    LabelSet {
                                        labels: [
                                            Label {
                                                name: "app.gazette.dev/managed-by",
                                                value: "estuary.dev/flow",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/build",
                                                value: "2121212121212121",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/log-level",
                                                value: "info",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/task-name",
                                                value: "the/derivation",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/task-type",
                                                value: "derivation",
                                                prefix: false,
                                            },
                                        ],
                                    },
                                ),
                                disable_wait_for_ack: false,
                                ring_buffer_size: 65536,
                                read_channel_size: 4096,
                            },
                        ),
                        recovery_log_template: Some(
                            JournalSpec {
                                name: "recovery/derivation/the/derivation/2020202020202020",
                                replication: 3,
                                labels: Some(
                                    LabelSet {
                                        labels: [
                                            Label {
                                                name: "app.gazette.dev/managed-by",
                                                value: "estuary.dev/flow",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "content-type",
                                                value: "application/x-gazette-recoverylog",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/build",
                                                value: "2121212121212121",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/task-name",
                                                value: "the/derivation",
                                                prefix: false,
                                            },
                                            Label {
                                                name: "estuary.dev/task-type",
                                                value: "derivation",
                                                prefix: false,
                                            },
                                        ],
                                    },
                                ),
                                fragment: Some(
                                    Fragment {
                                        length: 268435456,
                                        compression_codec: Snappy,
                                        stores: [
                                            "s3://a-bucket/",
                                        ],
                                        refresh_interval: Some(
                                            Duration {
                                                seconds: 300,
                                                nanos: 0,
                                            },
                                        ),
                                        retention: None,
                                        flush_interval: Some(
                                            Duration {
                                                seconds: 172800,
                                                nanos: 0,
                                            },
                                        ),
                                        path_postfix_template: "",
                                    },
                                ),
                                flags: 4,
                                max_append_rate: 4194304,
                                suspend: None,
                            },
                        ),
                        network_ports: [],
                        inactive_transforms: [],
                    },
                ),
            },
            previous_spec: NULL,
            is_touch: 0,
            dependency_hash: 5b38dc32c776e2b2,
        },
    ],
    built_materializations: [
        BuiltMaterialization {
            materialization: the/materialization,
            scope: test://example/catalog.yaml#/materializations/the~1materialization,
            control_id: "0000000000000000",
            data_plane_id: "1d1d1d1d1d1d1d1d",
            expect_pub_id: "0000000000000000",
            expect_build_id: "0000000000000000",
            model: {
              "endpoint": {
                "connector": {
                  "image": "other/image",
                  "config": {"a":"config"}
                }
              },
              "bindings": [
                {
                  "resource": {"_meta":{"path":["table","path"]},"name":"path","schema":"table"},
                  "source": "the/collection",
                  "fields": {
                    "recommended": true
                  }
                }
              ]
            },
            model_fixes: [
              "updated resource /_meta of 1 bindings"
            ],
            validated: Validated {
                bindings: [
                    Binding {
                        constraints: {
                            "F1": Constraint {
                                r#type: FieldOptional,
                                reason: "optional",
                            },
                            "f_one": Constraint {
                                r#type: LocationRecommended,
                                reason: "recommended",
                            },
                            "f_two": Constraint {
                                r#type: FieldRequired,
                                reason: "field required",
                            },
                            "flow_document": Constraint {
                                r#type: LocationRequired,
                                reason: "location required",
                            },
                        },
                        resource_path: [
                            "table",
                            "path",
                        ],
                        delta_updates: false,
                    },
                ],
            },
            spec: MaterializationSpec {
                name: "the/materialization",
                connector_type: Image,
                config_json: "{\"image\":\"other/image\",\"config\":{\"a\":\"config\"}}",
                bindings: [
                    Binding {
                        resource_config_json: "{\"name\":\"path\",\"schema\":\"table\"}",
                        resource_path: [
                            "table",
                            "path",
                        ],
                        collection: Some(
                            CollectionSpec {
                                name: "the/collection",
                                write_schema_json: "{\"$id\":\"test://example/catalog.yaml?ptr=/collections/the~1collection/schema\",\"properties\":{\"f_one\":{\"type\":\"integer\"},\"f_two\":{\"type\":\"string\"},\"f_x\":false},\"required\":[\"f_one\",\"f_two\"],\"type\":\"object\"}",
                                read_schema_json: "",
                                key: [
                                    "/f_one",
                                ],
                                uuid_ptr: "/_meta/uuid",
                                partition_fields: [],
                                projections: [
                                    Projection {
                                        ptr: "/f_one",
                                        field: "F1",
                                        explicit: true,
                                        is_partition_key: false,
                                        is_primary_key: true,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "integer",
                                                ],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: Some(
                                                    Numeric {
                                                        has_minimum: false,
                                                        minimum: 0.0,
                                                        has_maximum: false,
                                                        maximum: 0.0,
                                                    },
                                                ),
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_two",
                                        field: "F2",
                                        explicit: true,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "string",
                                                ],
                                                string: Some(
                                                    String {
                                                        content_type: "",
                                                        format: "",
                                                        content_encoding: "",
                                                        max_length: 0,
                                                    },
                                                ),
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/_meta/flow_truncated",
                                        field: "_meta/flow_truncated",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "boolean",
                                                ],
                                                string: None,
                                                title: "Flow truncation indicator",
                                                description: "Indicates whether any of the materialized values for this row have been truncated to make them fit inside the limitations of the destination system.",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_one",
                                        field: "f_one",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: true,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "integer",
                                                ],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: Some(
                                                    Numeric {
                                                        has_minimum: false,
                                                        minimum: 0.0,
                                                        has_maximum: false,
                                                        maximum: 0.0,
                                                    },
                                                ),
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_two",
                                        field: "f_two",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "string",
                                                ],
                                                string: Some(
                                                    String {
                                                        content_type: "",
                                                        format: "",
                                                        content_encoding: "",
                                                        max_length: 0,
                                                    },
                                                ),
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/f_x",
                                        field: "f_x",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Cannot,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "",
                                        field: "flow_document",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "object",
                                                ],
                                                string: None,
                                                title: "",
                                                description: "",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                    Projection {
                                        ptr: "/_meta/uuid",
                                        field: "flow_published_at",
                                        explicit: false,
                                        is_partition_key: false,
                                        is_primary_key: false,
                                        inference: Some(
                                            Inference {
                                                types: [
                                                    "string",
                                                ],
                                                string: Some(
                                                    String {
                                                        content_type: "",
                                                        format: "date-time",
                                                        content_encoding: "uuid",
                                                        max_length: 0,
                                                    },
                                                ),
                                                title: "Flow Publication Time",
                                                description: "Flow publication date-time of this document",
                                                default_json: "",
                                                secret: false,
                                                exists: Must,
                                                numeric: None,
                                                array: None,
                                            },
                                        ),
                                    },
                                ],
                                ack_template_json: "{\"_meta\":{\"ack\":true,\"uuid\":\"DocUUIDPlaceholder-329Bb50aa48EAa9ef\"}}",
                                partition_template: Some(
                                    JournalSpec {
                                        name: "the/collection/2020202020202020",
                                        replication: 3,
                                        labels: Some(
                                            LabelSet {
                                                labels: [
                                                    Label {
                                                        name: "app.gazette.dev/managed-by",
                                                        value: "estuary.dev/flow",
                                                        prefix: false,
                                                    },
                                                    Label {
                                                        name: "content-type",
                                                        value: "application/x-ndjson",
                                                        prefix: false,
                                                    },
                                                    Label {
                                                        name: "estuary.dev/build",
                                                        value: "2121212121212121",
                                                        prefix: false,
                                                    },
                                                    Label {
                                                        name: "estuary.dev/collection",
                                                        value: "the/collection",
                                                        prefix: false,
                                                    },
                                                ],
                                            },
                                        ),
                                        fragment: Some(
                                            Fragment {
                                                length: 536870912,
                                                compression_codec: Gzip,
                                                stores: [
                                                    "s3://a-bucket/",
                                                ],
                                                refresh_interval: Some(
                                                    Duration {
                                                        seconds: 300,
                                                        nanos: 0,
                                                    },
                                                ),
                                                retention: None,
                                                flush_interval: Some(
                                                    Duration {
                                                        seconds: 86400,
                                                        nanos: 0,
                                                    },
                                                ),
                                                path_postfix_template: "utc_date={{.Spool.FirstAppendTime.Format \"2006-01-02\"}}/utc_hour={{.Spool.FirstAppendTime.Format \"15\"}}",
                                            },
                                        ),
                                        flags: 4,
                                        max_append_rate: 4194304,
                                        suspend: None,
                                    },
                                ),
                                derivation: None,
                            },
                        ),
                        partition_selector: Some(
                            LabelSelector {
                                include: Some(
                                    LabelSet {
                                        labels: [
                                            Label {
                                                name: "estuary.dev/collection",
                                                value: "the/collection",
                                                prefix: false,
                                            },
                                        ],
                                    },
                                ),
                                exclude: Some(
                                    LabelSet {
                                        labels: [],
                                    },
                                ),
                            },
                        ),
                        priority: 0,
                        field_selection: Some(
                            FieldSelection {
                                keys: [
                                    "f_one",
                                ],
                                values: [
                                    "f_two",
                                ],
                                document: "flow_document",
                                field_config_json_map: {},
                            },
                        ),
                        delta_updates: false,
                        deprecated_shuffle: None,
                        journal_read_suffix: "materialize/the/materialization/table%2Fpath",
                        not_before: None,
                        not_after: None,
                        backfill: 0,
                        state_key: "table%2Fpath",
                    },
                ],
                shard_template: Some(
                    ShardSpec {
                        id: "materialize/the/materialization/2020202020202020",
                        sources: [],
                        recovery_log_prefix: "recovery",
                        hint_prefix: "/estuary/flow/hints",
                        hint_backups: 2,
                        max_txn_duration: Some(
                            Duration {
                                seconds: 300,
                                nanos: 0,
                            },
                        ),
                        min_txn_duration: Some(
                            Duration {
                                seconds: 0,
                                nanos: 0,
                            },
                        ),
                        disable: false,
                        hot_standbys: 0,
                        labels: Some(
                            LabelSet {
                                labels: [
                                    Label {
                                        name: "app.gazette.dev/managed-by",
                                        value: "estuary.dev/flow",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/build",
                                        value: "2121212121212121",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/log-level",
                                        value: "info",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-name",
                                        value: "the/materialization",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-type",
                                        value: "materialization",
                                        prefix: false,
                                    },
                                ],
                            },
                        ),
                        disable_wait_for_ack: false,
                        ring_buffer_size: 65536,
                        read_channel_size: 4096,
                    },
                ),
                recovery_log_template: Some(
                    JournalSpec {
                        name: "recovery/materialize/the/materialization/2020202020202020",
                        replication: 3,
                        labels: Some(
                            LabelSet {
                                labels: [
                                    Label {
                                        name: "app.gazette.dev/managed-by",
                                        value: "estuary.dev/flow",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "content-type",
                                        value: "application/x-gazette-recoverylog",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/build",
                                        value: "2121212121212121",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-name",
                                        value: "the/materialization",
                                        prefix: false,
                                    },
                                    Label {
                                        name: "estuary.dev/task-type",
                                        value: "materialization",
                                        prefix: false,
                                    },
                                ],
                            },
                        ),
                        fragment: Some(
                            Fragment {
                                length: 268435456,
                                compression_codec: Snappy,
                                stores: [
                                    "s3://a-bucket/",
                                ],
                                refresh_interval: Some(
                                    Duration {
                                        seconds: 300,
                                        nanos: 0,
                                    },
                                ),
                                retention: None,
                                flush_interval: Some(
                                    Duration {
                                        seconds: 172800,
                                        nanos: 0,
                                    },
                                ),
                                path_postfix_template: "",
                            },
                        ),
                        flags: 4,
                        max_append_rate: 4194304,
                        suspend: None,
                    },
                ),
                network_ports: [],
                inactive_bindings: [],
            },
            previous_spec: NULL,
            is_touch: 0,
            dependency_hash: 5b38dc32c776e2b2,
        },
    ],
    built_tests: [
        BuiltTest {
            test: the/test,
            scope: test://example/catalog.yaml#/tests/the~1test,
            control_id: "0000000000000000",
            expect_pub_id: "0000000000000000",
            expect_build_id: "0000000000000000",
            model: {
              "steps": [
                {
                  "ingest": {
                    "collection": "the/collection",
                    "documents": [{"f_one":42,"f_two":"a string"}]
                  }
                }
              ]
            },
            model_fixes: [],
            spec: TestSpec {
                name: "the/test",
                steps: [
                    Step {
                        step_type: Ingest,
                        step_index: 0,
                        description: "",
                        step_scope: "test://example/catalog.yaml#/tests/the~1test/0/ingest",
                        collection: "the/collection",
                        docs_json_vec: [
                            "{\"f_one\":42,\"f_two\":\"a string\"}",
                        ],
                        partitions: Some(
                            LabelSelector {
                                include: Some(
                                    LabelSet {
                                        labels: [
                                            Label {
                                                name: "estuary.dev/collection",
                                                value: "the/collection",
                                                prefix: false,
                                            },
                                        ],
                                    },
                                ),
                                exclude: Some(
                                    LabelSet {
                                        labels: [],
                                    },
                                ),
                            },
                        ),
                    },
                ],
            },
            previous_spec: NULL,
            is_touch: 0,
            dependency_hash: 5b38dc32c776e2b2,
        },
    ],
    captures: [
        DraftCapture {
            capture: the/capture,
            scope: test://example/catalog.yaml#/captures/the~1capture,
            expect_pub_id: "0000000000000000",
            model: {
              "endpoint": {
                "connector": {
                  "image": "an/image",
                  "config": {"a":"config"}
                }
              },
              "bindings": [
                {
                  "resource": {"_meta":{"path":["capture","path"]},"table":"foo"},
                  "target": "the/collection"
                }
              ]
            },
            is_touch: 0,
        },
    ],
    collections: [
        DraftCollection {
            collection: the/collection,
            scope: test://example/catalog.yaml#/collections/the~1collection,
            expect_pub_id: "0000000000000000",
            model: {
              "schema": {"$id":"test://example/catalog.yaml?ptr=/collections/the~1collection/schema","properties":{"f_one":{"type":"integer"},"f_two":{"type":"string"},"f_x":false},"required":["f_one","f_two"],"type":"object"},
              "key": [
                "/f_one"
              ],
              "projections": {
                "F1": "/f_one",
                "F2": "/f_two"
              }
            },
            is_touch: 0,
        },
        DraftCollection {
            collection: the/derivation,
            scope: test://example/catalog.yaml#/collections/the~1derivation,
            expect_pub_id: "0000000000000000",
            model: {
              "schema": {"$id":"test://example/catalog.yaml?ptr=/collections/the~1derivation/schema","properties":{"d_one":{"type":"integer"},"d_two":{"type":"string"}},"required":["d_one","d_two"],"type":"object"},
              "key": [
                "/d_one"
              ],
              "derive": {
                "using": {
                  "sqlite": {}
                },
                "transforms": [
                  {
                    "name": "fromCollection",
                    "source": {
                      "name": "the/collection"
                    },
                    "shuffle": {
                      "key": [
                        "/f_two"
                      ]
                    },
                    "lambda": "select 123 as d_one, 'hello' as d_two;\n"
                  }
                ]
              }
            },
            is_touch: 0,
        },
    ],
    errors: [],
    errors_draft: [],
    fetches: [
        Fetch {
            depth: 1,
            resource: test://example/catalog.yaml,
        },
    ],
    imports: [],
    materializations: [
        DraftMaterialization {
            materialization: the/materialization,
            scope: test://example/catalog.yaml#/materializations/the~1materialization,
            expect_pub_id: "0000000000000000",
            model: {
              "endpoint": {
                "connector": {
                  "image": "other/image",
                  "config": {"a":"config"}
                }
              },
              "bindings": [
                {
                  "resource": {"name":"path","schema":"table"},
                  "source": "the/collection",
                  "fields": {
                    "recommended": true
                  }
                }
              ]
            },
            is_touch: 0,
        },
    ],
    resources: [
        Resource {
            resource: test://example/catalog.yaml,
            content_type: "CATALOG",
            content: ".. binary ..",
            content_dom: {"captures":{"the/capture":{"bindings":[{"resource":{"_meta":{"path":["capture","path"]},"table":"foo"},"target":"the/collection"}],"endpoint":{"connector":{"config":{"a":"config"},"image":"an/image"}},"expectPubId":"00:00:00:00:00:00:00:00"}},"collections":{"the/collection":{"expectPubId":"00:00:00:00:00:00:00:00","key":["/f_one"],"projections":{"F1":"/f_one","F2":"/f_two"},"schema":{"properties":{"f_one":{"type":"integer"},"f_two":{"type":"string"},"f_x":false},"required":["f_one","f_two"],"type":"object"}},"the/derivation":{"derive":{"transforms":[{"lambda":"select 123 as d_one, 'hello' as d_two;\n","name":"fromCollection","shuffle":{"key":["/f_two"]},"source":{"name":"the/collection"}}],"using":{"sqlite":{}}},"expectPubId":"00:00:00:00:00:00:00:00","key":["/d_one"],"schema":{"properties":{"d_one":{"type":"integer"},"d_two":{"type":"string"}},"required":["d_one","d_two"],"type":"object"}}},"materializations":{"the/materialization":{"bindings":[{"resource":{"name":"path","schema":"table"},"source":"the/collection"}],"endpoint":{"connector":{"config":{"a":"config"},"image":"other/image"}},"expectPubId":"00:00:00:00:00:00:00:00"}},"tests":{"the/test":{"expectPubId":"00:00:00:00:00:00:00:00","steps":[{"ingest":{"collection":"the/collection","documents":[{"f_one":42,"f_two":"a string"}]}}]}}},
        },
    ],
    storage_mappings: [
        StorageMapping {
            catalog_prefix: ,
            control_id: "0000000000000000",
            stores: [
              {
                "provider": "S3",
                "bucket": "a-bucket",
                "prefix": null,
                "region": null
              }
            ],
        },
    ],
    tests: [
        DraftTest {
            test: the/test,
            scope: test://example/catalog.yaml#/tests/the~1test,
            expect_pub_id: "0000000000000000",
            model: {
              "steps": [
                {
                  "ingest": {
                    "collection": "the/collection",
                    "documents": [{"f_one":42,"f_two":"a string"}]
                  }
                }
              ]
            },
            is_touch: 0,
        },
    ],
}

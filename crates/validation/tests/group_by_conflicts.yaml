test://example/catalog.yaml:
  collections:
    the/collection:
      schema:
        type: object
        properties:
          f_one: { type: integer }
          f_two: { type: integer }
      key: [/f_one, /f_two] # Changed from just /f_one.

  materializations:
    the/materialization:
      endpoint:
        connector:
          image: an/image:test
          config: {}
      bindings: &the_bindings
        - source: the/collection
          resource:
            _meta: { path: [a] }
            table: a
          fields:
            recommended: 1

driver:
  dataPlanes:
    "1d:1d:1d:1d:1d:1d:1d:1d":
      default: true

  liveCollections:
    the/collection:
      controlId: "11:11:11:11:11:11:11:04"
      dataPlaneId: "1d:1d:1d:1d:1d:1d:1d:1d"
      lastPubId: "10:10:10:10:10:10:10:10"
      key: [/f_one]

  liveMaterializations:
    the/materialization:
      controlId: "11:11:11:11:11:11:11:04"
      dataPlaneId: "1d:1d:1d:1d:1d:1d:1d:1d"
      lastPubId: "10:10:10:10:10:10:10:10"
      bindings: *the_bindings
      lastFields:
        - keys: [f_one]

  materializations:
    the/materialization:
      connectorType: IMAGE
      config:
        image: an/image:test
        config: {}
      bindings:
        - constraints:
            f_one: { type: 4, reason: "optional" }
            f_two: { type: 4, reason: "optional" }
          resourcePath: [a]

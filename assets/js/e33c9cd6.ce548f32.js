"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[8419],{28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>i});var o=n(96540);const r={},s=o.createContext(r);function c(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),o.createElement(s.Provider,{value:t},e.children)}},64241:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>c,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"reference/Connectors/capture-connectors/google-pubsub","title":"Google Cloud Pub/Sub","description":"This connector captures messages in JSON format into Flow collections from","source":"@site/docs/reference/Connectors/capture-connectors/google-pubsub.md","sourceDirName":"reference/Connectors/capture-connectors","slug":"/reference/Connectors/capture-connectors/google-pubsub","permalink":"/reference/Connectors/capture-connectors/google-pubsub","draft":false,"unlisted":false,"editUrl":"https://github.com/estuary/flow/edit/master/site/docs/reference/Connectors/capture-connectors/google-pubsub.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Google Play","permalink":"/reference/Connectors/capture-connectors/google-play"},"next":{"title":"Google Search Console","permalink":"/reference/Connectors/capture-connectors/google-search-console"}}');var r=n(74848),s=n(28453);const c={},i="Google Cloud Pub/Sub",l={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Service Account",id:"service-account",level:3},{value:"Service Account Key",id:"service-account-key",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Properties",id:"properties",level:3},{value:"Endpoint",id:"endpoint",level:4},{value:"Bindings",id:"bindings",level:4},{value:"At-Least-Once Message Capture",id:"at-least-once-message-capture",level:3},{value:"Message Format",id:"message-format",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"google-cloud-pubsub",children:"Google Cloud Pub/Sub"})}),"\n",(0,r.jsx)(t.p,{children:"This connector captures messages in JSON format into Flow collections from\nGoogle Cloud Pub/Sub topics."}),"\n",(0,r.jsxs)(t.p,{children:["During setup, this connector will discover all topics it has access to. Each\n",(0,r.jsx)(t.a,{href:"/concepts/#resources-and-bindings",children:"capture binding"})," that is\nenabled for a topic will automatically create a new subscription, and the\nconnector will read messages from that subscription."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"https://ghcr.io/estuary/source-google-pubsub:dev",children:(0,r.jsx)(t.code,{children:"ghcr.io/estuary/source-google-pubsub:dev"})})," provides the latest connector image. You can also follow the link in your browser to see past image versions."]}),"\n",(0,r.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(t.p,{children:"To use this connector, you will need the following prerequisites:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"A Google Cloud Project with Pub/Sub enabled"}),"\n",(0,r.jsx)(t.li,{children:'A Google Cloud Service Account with the "Pub/Sub Editor" roles in your GCP project'}),"\n",(0,r.jsx)(t.li,{children:"A Service Account Key to authenticate into your Service Account"}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"See the setup guide for more information about how to create the required resources."}),"\n",(0,r.jsx)(t.h3,{id:"service-account",children:"Service Account"}),"\n",(0,r.jsx)(t.p,{children:'To sync data from Pub/Sub, you need credentials for a Service Account with the\n"Pub/Sub Editor" role.  This role grants the necessary permissions to discover\ntopics, create subscriptions to those topics, and read messages from the\nsubscriptions. It is recommended to create a dedicated Service Account to\nfacilitate permission management and auditing. However, if you already have a\nService Account with the correct permissions, you can use it.'}),"\n",(0,r.jsx)(t.p,{children:"Here's how to provision a suitable service account:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["Follow Google Cloud Platform's instructions for ",(0,r.jsx)(t.a,{href:"https://cloud.google.com/iam/docs/service-accounts-create#creating",children:"Creating a Service\nAccount"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Note down the ID of the service account you just created. Service Account IDs\ntypically follow the format\n",(0,r.jsx)(t.code,{children:"<account-name>@<project-name>.iam.gserviceaccount.com"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Follow Google Cloud Platform's instructions for ",(0,r.jsx)(t.a,{href:"https://cloud.google.com/iam/docs/grant-role-console#grant_an_iam_role",children:"Granting IAM\nRoles"}),'\nto the new service account. The "principal" email address should be the ID of\nthe service account you just created, and the role granted should be "Pub/Sub\nEditor".']}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"service-account-key",children:"Service Account Key"}),"\n",(0,r.jsx)(t.p,{children:"Service Account Keys are used to authenticate as Google Service Accounts. To be\nable to utilize the permissions granted to the Service Account in the previous\nstep, you'll need to provide its Service Account Key when creating the capture.\nIt is a good practice, though not required, to create a new key for Flow even if\nyou're reusing a preexisting account."}),"\n",(0,r.jsxs)(t.p,{children:["To create a new key for a service account, follow Google Cloud Platform's\ninstructions for ",(0,r.jsx)(t.a,{href:"https://cloud.google.com/iam/docs/keys-create-delete#creating",children:"Creating a Service Account\nKey"}),". Be sure to\ncreate the key in JSON format. Once the linked instructions have been followed\nyou should have a key file, which will need to be uploaded to Flow when setting\nup your capture."]}),"\n",(0,r.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(t.p,{children:["You configure connectors either in the Flow web app, or by directly editing the\ncatalog specification file. See\n",(0,r.jsx)(t.a,{href:"/concepts/connectors#using-connectors",children:"connectors"})," to learn more\nabout using connectors."]}),"\n",(0,r.jsx)(t.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(t.h4,{id:"endpoint",children:"Endpoint"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Property"}),(0,r.jsx)(t.th,{children:"Title"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Required/Default"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"/projectId"})})}),(0,r.jsx)(t.td,{children:"Project ID"}),(0,r.jsx)(t.td,{children:"Google Cloud Project ID that contains the PubSub topics."}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"Required"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"/credentialsJson"})})}),(0,r.jsx)(t.td,{children:"Service Account JSON"}),(0,r.jsx)(t.td,{children:"Google Cloud Service Account JSON credentials to use for authentication."}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"Required"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"/subscriptionPrefix"})}),(0,r.jsx)(t.td,{children:"Subscription Prefix"}),(0,r.jsx)(t.td,{children:"Prefix to prepend to the PubSub topics subscription names."}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{})]})]})]}),"\n",(0,r.jsx)(t.h4,{id:"bindings",children:"Bindings"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Property"}),(0,r.jsx)(t.th,{children:"Title"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Required/Default"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"/topic"})})}),(0,r.jsx)(t.td,{children:"Topic"}),(0,r.jsx)(t.td,{children:"Name of the PubSub topic to subscribe to."}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"Required"})]})})]}),"\n",(0,r.jsx)(t.h3,{id:"at-least-once-message-capture",children:"At-Least-Once Message Capture"}),"\n",(0,r.jsx)(t.p,{children:'Received messages are acknowledged to Pub/Sub after they have been durably\ncommitted to your Flow collection. After Pub/Sub receives acknowledgement of\nmessages, it will not attempt to re-deliver messages to subscribers if\nsubscriptions are created with "exactly-once delivery", which this connector\ndoes set when it creates subscriptions. Occasionally messages will be captured\nto your Flow collection more than once if the connector is restarted after it\nhas durably committed the document to the collection but before it has\nacknowledged the message to Pub/Sub.'}),"\n",(0,r.jsxs)(t.p,{children:['In this way the committing of the message to your Flow collection is considered\na "side effect" of processing the message, and ',(0,r.jsx)(t.a,{href:"https://cloud.google.com/blog/products/data-analytics/cloud-pub-sub-exactly-once-delivery-feature-is-now-ga",children:"Pub/Sub does not provide\nguarantees around exactly-once side\neffects"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["If you materialize the collections using standard updates, duplicate documents\nwill automatically be de-duplicated in the destination based on the ID of the\ndocuments. Materializations that use ",(0,r.jsx)(t.a,{href:"/concepts/materialization#delta-updates",children:"delta\nupdates"})," need to consider\nthe potential for more than one document with the same ID."]}),"\n",(0,r.jsx)(t.h3,{id:"message-format",children:"Message Format"}),"\n",(0,r.jsxs)(t.p,{children:["Currently only messages with data in JSON format can be processed. Data in other\nformats will cause errors with the capture connector. Support for other formats\nis planned - reach out to ",(0,r.jsx)(t.a,{href:"mailto:support@estuary.dev",children:"support@estuary.dev"})," if your use case requires\nprocessing data in a different format."]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);
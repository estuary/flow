"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[3406],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>d});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},56591:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"reference/Connectors/materialization-connectors/Snowflake","title":"Snowflake","description":"This connector materializes Flow collections into tables in a Snowflake database.","source":"@site/docs/reference/Connectors/materialization-connectors/Snowflake.md","sourceDirName":"reference/Connectors/materialization-connectors","slug":"/reference/Connectors/materialization-connectors/Snowflake","permalink":"/reference/Connectors/materialization-connectors/Snowflake","draft":false,"unlisted":false,"editUrl":"https://github.com/estuary/flow/edit/master/site/docs/reference/Connectors/materialization-connectors/Snowflake.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Slack","permalink":"/reference/Connectors/materialization-connectors/slack"},"next":{"title":"SQLite","permalink":"/reference/Connectors/materialization-connectors/SQLite"}}');var r=t(74848),i=t(28453);const a={},d="Snowflake",l={},o=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setup",id:"setup",level:3},{value:"Key-pair Authentication",id:"key-pair-authentication",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Properties",id:"properties",level:3},{value:"Endpoint",id:"endpoint",level:4},{value:"Bindings",id:"bindings",level:4},{value:"Sample",id:"sample",level:3},{value:"Sync Schedule",id:"sync-schedule",level:2},{value:"Delta updates",id:"delta-updates",level:2},{value:"Performance considerations",id:"performance-considerations",level:2},{value:"Optimizing performance for standard updates",id:"optimizing-performance-for-standard-updates",level:3},{value:"Snowpipe Streaming",id:"snowpipe-streaming",level:3},{value:"Timestamp Data Type Mapping",id:"timestamp-data-type-mapping",level:2},{value:"Reserved words",id:"reserved-words",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"snowflake",children:"Snowflake"})}),"\n",(0,r.jsxs)(n.p,{children:["This connector materializes Flow collections into tables in a Snowflake database.\nIt allows both standard and ",(0,r.jsx)(n.a,{href:"#delta-updates",children:"delta updates"}),". ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/data-load-snowpipe-streaming-overview",children:"Snowpipe Streaming"})," is additionally available for delta update bindings."]}),"\n",(0,r.jsxs)(n.p,{children:["The connector first uploads data changes to a ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/data-load-local-file-system-create-stage.html#table-stages",children:"Snowflake table stage"}),".\nFrom there, it transactionally applies the changes to the Snowflake table."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://ghcr.io/estuary/materialize-snowflake:dev",children:(0,r.jsx)(n.code,{children:"ghcr.io/estuary/materialize-snowflake:dev"})})," provides the latest connector image. You can also follow the link in your browser to see past image versions."]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"To use this connector, you'll need:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A Snowflake account that includes:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A target database, to which you'll materialize data"}),"\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/sql-reference/ddl-database.html",children:"schema"})," \u2014 a logical grouping of database objects \u2014 within the target database"]}),"\n",(0,r.jsx)(n.li,{children:"A virtual warehouse"}),"\n",(0,r.jsx)(n.li,{children:"A user with a role assigned that grants the appropriate access levels to these resources."}),"\n",(0,r.jsxs)(n.li,{children:["The correct timezone setting ",(0,r.jsx)(n.code,{children:"TIMESTAMP_LTZ"})," or\n",(0,r.jsx)(n.code,{children:"TIMESTAMP_TZ"})," (see ",(0,r.jsx)(n.a,{href:"#timestamp-data-type-mapping",children:"Timestamp Data Type Mapping"}),")"]}),"\n"]}),"\n","See the ",(0,r.jsx)(n.a,{href:"#setup",children:"script below"})," for details."]}),"\n",(0,r.jsxs)(n.li,{children:["Know your Snowflake account's host URL. This is formatted using your ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#where-are-account-identifiers-used",children:"Snowflake account identifier"}),",\nfor example, ",(0,r.jsx)(n.code,{children:"orgname-accountname.snowflakecomputing.com"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"At least one Flow collection"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["If you haven't yet captured your data from its external source, start at the beginning of the ",(0,r.jsx)(n.a,{href:"/guides/create-dataflow",children:"guide to create a dataflow"}),". You'll be referred back to this connector-specific documentation at the appropriate steps."]})}),"\n",(0,r.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,r.jsx)(n.p,{children:"To meet the prerequisites, copy and paste the following script into the Snowflake SQL editor, replacing the variable names in the first five lines."}),"\n",(0,r.jsxs)(n.p,{children:["If you'd like to use an existing database, warehouse, and/or schema, be sure to set\n",(0,r.jsx)(n.code,{children:"database_name"}),", ",(0,r.jsx)(n.code,{children:"warehouse_name"}),", and ",(0,r.jsx)(n.code,{children:"estuary_schema"})," accordingly. If you specify a new name, the script will create the item for you. You can set ",(0,r.jsx)(n.code,{children:"estuary_role"}),"\nand ",(0,r.jsx)(n.code,{children:"estuary_user"})," to whatever you'd like."]}),"\n",(0,r.jsxs)(n.p,{children:["Check the ",(0,r.jsx)(n.strong,{children:"All Queries"})," check box, and click ",(0,r.jsx)(n.strong,{children:"Run"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"set database_name = 'ESTUARY_DB';\nset warehouse_name = 'ESTUARY_WH';\nset estuary_role = 'ESTUARY_ROLE';\nset estuary_user = 'ESTUARY_USER';\nset estuary_schema = 'ESTUARY_SCHEMA';\n-- create role and schema for Estuary\ncreate role if not exists identifier($estuary_role);\ngrant role identifier($estuary_role) to role SYSADMIN;\n-- Create snowflake DB\ncreate database if not exists identifier($database_name);\nuse database identifier($database_name);\ncreate schema if not exists identifier($estuary_schema);\n-- create a user for Estuary\ncreate user if not exists identifier($estuary_user)\ndefault_role = $estuary_role\ndefault_warehouse = $warehouse_name;\ngrant role identifier($estuary_role) to user identifier($estuary_user);\ngrant all on schema identifier($estuary_schema) to identifier($estuary_role);\n-- create a warehouse for estuary\ncreate warehouse if not exists identifier($warehouse_name)\nwarehouse_size = xsmall\nwarehouse_type = standard\nauto_suspend = 60\nauto_resume = true\ninitially_suspended = true;\n-- grant Estuary role access to warehouse\ngrant USAGE\non warehouse identifier($warehouse_name)\nto role identifier($estuary_role);\n-- grant Estuary access to database\ngrant CREATE SCHEMA, MONITOR, USAGE on database identifier($database_name) to role identifier($estuary_role);\n-- change role to ACCOUNTADMIN for STORAGE INTEGRATION support to Estuary (only needed for Snowflake on GCP)\nuse role ACCOUNTADMIN;\ngrant CREATE INTEGRATION on account to role identifier($estuary_role);\nuse role sysadmin;\n-- Optional: Set the timestamp type to `TIMESTAMP_TZ`; otherwise defaults to using `TIMESTAMP_LTZ`\n-- ALTER USER $estuary_user SET TIMESTAMP_TYPE_MAPPING = 'TIMESTAMP_TZ';\nCOMMIT;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"key-pair-authentication",children:"Key-pair Authentication"}),"\n",(0,r.jsxs)(n.p,{children:["As username and password authentication was deprecated in April 2025, you need to authenticate\nusing ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/key-pair-auth",children:"key-pair authentication"}),", also known as JWT authentication."]}),"\n",(0,r.jsx)(n.p,{children:"To set up your user for key-pair authentication, first generate a key-pair in your shell:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# generate a private key\nopenssl genrsa 2048 | openssl pkcs8 -topk8 -inform PEM -out rsa_key.p8 -nocrypt\n# generate a public key\nopenssl rsa -in rsa_key.p8 -pubout -out rsa_key.pub\n# read the public key and copy it to clipboard\ncat rsa_key.pub\n\n-----BEGIN PUBLIC KEY-----\nMIIBIj...\n-----END PUBLIC KEY-----\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then assign the public key with your Snowflake user using these SQL commands:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"ALTER USER $estuary_user SET RSA_PUBLIC_KEY='MIIBIjANBgkqh...'\n"})}),"\n",(0,r.jsx)(n.p,{children:"Verify the public key fingerprint in Snowflake matches the one you have locally:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"DESC USER $estuary_user;\nSELECT TRIM((SELECT \"value\" FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()))\n  WHERE \"property\" = 'RSA_PUBLIC_KEY_FP'), 'SHA256:');\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then compare with the local version:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"openssl rsa -pubin -in rsa_key.pub -outform DER | openssl dgst -sha256 -binary | openssl enc -base64\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Now you can use the generated ",(0,r.jsx)(n.em,{children:"private key"})," when configuring your Snowflake connector."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"Key-pair authentication is required for delta updates bindings to use Snowpipe Streaming."})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"To use this connector, begin with data in one or more Flow collections.\nUse the below properties to configure a Snowflake materialization, which will direct one or more of your Flow collections to new Snowflake tables."}),"\n",(0,r.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(n.h4,{id:"endpoint",children:"Endpoint"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Title"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required/Default"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/host"})})}),(0,r.jsx)(n.td,{children:"Host (Account URL)"}),(0,r.jsx)(n.td,{children:"The Snowflake Host used for the connection. Example: orgname-accountname.snowflakecomputing.com (do not include the protocol)."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/database"})})}),(0,r.jsx)(n.td,{children:"Database"}),(0,r.jsx)(n.td,{children:"Name of the Snowflake database to which to materialize"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/schema"})})}),(0,r.jsx)(n.td,{children:"Schema"}),(0,r.jsx)(n.td,{children:"Database schema for bound collection tables (unless overridden within the binding resource configuration) as well as associated materialization metadata tables"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/warehouse"})}),(0,r.jsx)(n.td,{children:"Warehouse"}),(0,r.jsx)(n.td,{children:"Name of the data warehouse that contains the database"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/role"})}),(0,r.jsx)(n.td,{children:"Role"}),(0,r.jsx)(n.td,{children:"Role assigned to the user"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/account"})}),(0,r.jsx)(n.td,{children:"Account"}),(0,r.jsx)(n.td,{children:"The Snowflake account identifier"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/credentials"})})}),(0,r.jsx)(n.td,{children:"Credentials"}),(0,r.jsx)(n.td,{children:"Credentials for authentication"}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/credentials/auth_type"})})}),(0,r.jsx)(n.td,{children:"Authentication type"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"jwt"})," is the only supported authentication method currently"]}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/credentials/user"})})}),(0,r.jsx)(n.td,{children:"User"}),(0,r.jsx)(n.td,{children:"Snowflake username"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/credentials/password"})}),(0,r.jsx)(n.td,{children:"Password"}),(0,r.jsx)(n.td,{children:"Deprecated"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Deprecated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/credentials/privateKey"})}),(0,r.jsx)(n.td,{children:"Private Key"}),(0,r.jsx)(n.td,{children:"Required if using jwt authentication"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/advanced/disableFieldTruncation"})}),(0,r.jsx)(n.td,{children:"Disable Field Truncation"}),(0,r.jsx)(n.td,{children:"Disables truncation of large materialized fields"}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"bindings",children:"Bindings"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Title"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required/Default"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/table"})})}),(0,r.jsx)(n.td,{children:"Table"}),(0,r.jsx)(n.td,{children:"Table name"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/schema"})}),(0,r.jsx)(n.td,{children:"Alternative Schema"}),(0,r.jsx)(n.td,{children:"Alternative schema for this table"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/delta_updates"})}),(0,r.jsx)(n.td,{children:"Delta updates"}),(0,r.jsxs)(n.td,{children:["Whether to use standard or ",(0,r.jsx)(n.a,{href:"#delta-updates",children:"delta updates"})]}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"sample",children:"Sample"}),"\n",(0,r.jsx)(n.p,{children:"Key-pair authentication:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"materializations:\n  ${PREFIX}/${mat_name}:\n    endpoint:\n  \t    connector:\n    \t    config:\n              database: acmeCo_db\n              host: orgname-accountname.snowflakecomputing.com\n              schema: acmeCo_flow_schema\n              warehouse: acmeCo_warehouse\n              credentials:\n                auth_type: jwt\n                user: snowflake_user\n                privateKey: |\n                  -----BEGIN PRIVATE KEY-----\n                  MIIEv....\n                  ...\n                  ...\n                  ...\n                  ...\n                  ...\n                  -----END PRIVATE KEY-----\n    \t    image: ghcr.io/estuary/materialize-snowflake:dev\n  # If you have multiple collections you need to materialize, add a binding for each one\n    # to ensure complete data flow-through\n    bindings:\n  \t- resource:\n      \ttable: ${table_name}\n    source: ${PREFIX}/${source_collection}\n"})}),"\n",(0,r.jsx)(n.p,{children:"(DEPRECATED) User and password authentication:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"materializations:\n  ${PREFIX}/${mat_name}:\n    endpoint:\n  \t    connector:\n    \t    config:\n              database: acmeCo_db\n              host: orgname-accountname.snowflakecomputing.com\n              schema: acmeCo_flow_schema\n              warehouse: acmeCo_warehouse\n              credentials:\n                auth_type: user_pasword\n                user: snowflake_user\n                password: secret\n    \t    image: ghcr.io/estuary/materialize-snowflake:dev\n  # If you have multiple collections you need to materialize, add a binding for each one\n    # to ensure complete data flow-through\n    bindings:\n  \t- resource:\n      \ttable: ${table_name}\n    source: ${PREFIX}/${source_collection}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"sync-schedule",children:"Sync Schedule"}),"\n",(0,r.jsxs)(n.p,{children:["This connector supports configuring a schedule for sync frequency. You can read\nabout how to configure this ",(0,r.jsx)(n.a,{href:"/reference/materialization-sync-schedule",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake compute is ",(0,r.jsx)(n.a,{href:"https://www.snowflake.com/pricing/",children:"priced"})," per second of\nactivity, with a minimum of 60 seconds. Inactive warehouses don't incur charges.\nTo keep costs down, you'll want to minimize your warehouse's active time."]}),"\n",(0,r.jsx)(n.p,{children:"To accomplish this, we recommend a two-pronged approach:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/sql-reference/sql/create-warehouse.html#:~:text=Specifies%20the%20number%20of%20seconds%20of%20inactivity%20after%20which%20a%20warehouse%20is%20automatically%20suspended.",children:"Configure your Snowflake warehouse to auto-suspend"})," after 60 seconds."]}),"\n",(0,r.jsx)(n.p,{children:"This ensures that after each transaction completes, you'll only be charged for one minute of compute, Snowflake's smallest granularity."}),"\n",(0,r.jsx)(n.p,{children:"Use a query like the one shown below, being sure to substitute your warehouse name:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"ALTER WAREHOUSE ESTUARY_WH SET auto_suspend = 60;\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Configure the materialization's ",(0,r.jsx)(n.strong,{children:"Sync Schedule"})," based on your requirements for data freshness."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"delta-updates",children:"Delta updates"}),"\n",(0,r.jsxs)(n.p,{children:["This connector supports both standard (merge) and ",(0,r.jsx)(n.a,{href:"/concepts/materialization#delta-updates",children:"delta updates"}),".\nThe default is to use standard updates."]}),"\n",(0,r.jsx)(n.p,{children:"Enabling delta updates will prevent Flow from querying for documents in your Snowflake table, which can reduce latency and costs for large datasets.\nIf you're certain that all events will have unique keys, enabling delta updates is a simple way to improve\nperformance with no effect on the output.\nHowever, enabling delta updates is not suitable for all workflows, as the resulting table in Snowflake won't be fully reduced."}),"\n",(0,r.jsx)(n.p,{children:"You can enable delta updates on a per-binding basis:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"    bindings:\n  \t- resource:\n      \ttable: ${table_name}\n        delta_updates: true\n    source: ${PREFIX}/${source_collection}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-considerations",children:"Performance considerations"}),"\n",(0,r.jsx)(n.h3,{id:"optimizing-performance-for-standard-updates",children:"Optimizing performance for standard updates"}),"\n",(0,r.jsxs)(n.p,{children:["When using standard updates for a large dataset, the ",(0,r.jsx)(n.a,{href:"/concepts/collections#keys",children:"collection key"})," you choose can have a significant impact on materialization performance and efficiency."]}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake uses ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/tables-clustering-micropartitions.html",children:"micro partitions"})," to physically arrange data within tables.\nEach micro partition includes metadata, such as the minimum and maximum values for each column.\nIf you choose a collection key that takes advantage of this metadata to help Snowflake prune irrelevant micro partitions,\nyou'll see dramatically better performance."]}),"\n",(0,r.jsxs)(n.p,{children:["For example, if you materialize a collection with a key of ",(0,r.jsx)(n.code,{children:"/user_id"}),", it will tend to perform far worse than a materialization of ",(0,r.jsx)(n.code,{children:"/date, /user_id"}),".\nThis is because most materializations tend to be roughly chronological over time, and that means that data is written to Snowflake in roughly ",(0,r.jsx)(n.code,{children:"/date"})," order."]}),"\n",(0,r.jsxs)(n.p,{children:["This means that updates of keys ",(0,r.jsx)(n.code,{children:"/date, /user_id"})," will need to physically read far fewer rows as compared to a key like ",(0,r.jsx)(n.code,{children:"/user_id"}),",\nbecause those rows will tend to live in the same micro-partitions, and Snowflake is able to cheaply prune micro-partitions that aren't relevant to the transaction."]}),"\n",(0,r.jsx)(n.h3,{id:"snowpipe-streaming",children:"Snowpipe Streaming"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/data-load-snowpipe-streaming-overview",children:"Snowpipe Streaming"})," is the lowest-latency method to load data into Snowflake.\nSnowpipe Streaming is used by default for ",(0,r.jsx)(n.a,{href:"#delta-updates",children:"delta updates"})," bindings. This method of ingress writes rows directly to Snowflake tables and scales compute automatically based on load."]}),"\n",(0,r.jsx)(n.h2,{id:"timestamp-data-type-mapping",children:"Timestamp Data Type Mapping"}),"\n",(0,r.jsxs)(n.p,{children:["Flow materializes timestamp data types as either ",(0,r.jsx)(n.code,{children:"TIMESTAMP_LTZ"})," or\n",(0,r.jsx)(n.code,{children:"TIMESTAMP_TZ"})," columns in Snowflake. ",(0,r.jsx)(n.code,{children:"TIMESTAMP_LTZ"})," is used unless the\nSnowflake  ",(0,r.jsx)(n.code,{children:"TIMESTAMP_TYPE_MAPPING"})," configuration is set to ",(0,r.jsx)(n.code,{children:"TIMESTAMP_TZ"}),",\nwhich will cause Flow to use ",(0,r.jsx)(n.code,{children:"TIMESTAMP_TZ"})," columns. Flow never creates columns\nas ",(0,r.jsx)(n.code,{children:"TIMESTAMP_NTZ"}),". See Snowflake documentation on the ",(0,r.jsxs)(n.a,{href:"https://docs.snowflake.com/en/sql-reference/parameters#timestamp-type-mapping",children:[(0,r.jsx)(n.code,{children:"TIMESTAMP_TYPE_MAPPING"})," configuration"]})," and\nthe ",(0,r.jsxs)(n.a,{href:"https://docs.snowflake.com/en/sql-reference/data-types-datetime#label-datatypes-timestamp-variations",children:[(0,r.jsx)(n.code,{children:"TIMESTAMP_TZ or TIMESTAMP_LTZ"})," values"]})," for more information."]}),"\n",(0,r.jsx)(n.h2,{id:"reserved-words",children:"Reserved words"}),"\n",(0,r.jsxs)(n.p,{children:["Snowflake has a list of reserved words that must be quoted in order to be used as an identifier. Flow automatically quotes fields that are in the reserved words list. You can find this list in Snowflake's documentation ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/sql-reference/reserved-keywords.html",children:"here"})," and in the table below."]}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.p,{children:["In Snowflake, objects created with quoted identifiers must always be referenced exactly as created, including the quotes. Otherwise, SQL statements and queries can result in errors. See the ",(0,r.jsx)(n.a,{href:"https://docs.snowflake.com/en/sql-reference/identifiers-syntax.html#double-quoted-identifiers",children:"Snowflake docs"}),"."]})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Reserved words"}),(0,r.jsx)(n.th,{}),(0,r.jsx)(n.th,{})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"account"}),(0,r.jsx)(n.td,{children:"from"}),(0,r.jsx)(n.td,{children:"qualify"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"all"}),(0,r.jsx)(n.td,{children:"full"}),(0,r.jsx)(n.td,{children:"regexp"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"alter"}),(0,r.jsx)(n.td,{children:"grant"}),(0,r.jsx)(n.td,{children:"revoke"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"and"}),(0,r.jsx)(n.td,{children:"group"}),(0,r.jsx)(n.td,{children:"right"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"gscluster"}),(0,r.jsx)(n.td,{children:"rlike"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"as"}),(0,r.jsx)(n.td,{children:"having"}),(0,r.jsx)(n.td,{children:"row"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"between"}),(0,r.jsx)(n.td,{children:"ilike"}),(0,r.jsx)(n.td,{children:"rows"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"by"}),(0,r.jsx)(n.td,{children:"in"}),(0,r.jsx)(n.td,{children:"sample"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"case"}),(0,r.jsx)(n.td,{children:"increment"}),(0,r.jsx)(n.td,{children:"schema"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"cast"}),(0,r.jsx)(n.td,{children:"inner"}),(0,r.jsx)(n.td,{children:"select"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"check"}),(0,r.jsx)(n.td,{children:"insert"}),(0,r.jsx)(n.td,{children:"set"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"column"}),(0,r.jsx)(n.td,{children:"intersect"}),(0,r.jsx)(n.td,{children:"some"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"connect"}),(0,r.jsx)(n.td,{children:"into"}),(0,r.jsx)(n.td,{children:"start"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"connection"}),(0,r.jsx)(n.td,{children:"is"}),(0,r.jsx)(n.td,{children:"table"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"constraint"}),(0,r.jsx)(n.td,{children:"issue"}),(0,r.jsx)(n.td,{children:"tablesample"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"create"}),(0,r.jsx)(n.td,{children:"join"}),(0,r.jsx)(n.td,{children:"then"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"cross"}),(0,r.jsx)(n.td,{children:"lateral"}),(0,r.jsx)(n.td,{children:"to"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current"}),(0,r.jsx)(n.td,{children:"left"}),(0,r.jsx)(n.td,{children:"trigger"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current_date"}),(0,r.jsx)(n.td,{children:"like"}),(0,r.jsx)(n.td,{children:"true"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current_time"}),(0,r.jsx)(n.td,{children:"localtime"}),(0,r.jsx)(n.td,{children:"try_cast"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current_timestamp"}),(0,r.jsx)(n.td,{children:"localtimestamp"}),(0,r.jsx)(n.td,{children:"union"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current_user"}),(0,r.jsx)(n.td,{children:"minus"}),(0,r.jsx)(n.td,{children:"unique"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"database"}),(0,r.jsx)(n.td,{children:"natural"}),(0,r.jsx)(n.td,{children:"update"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"delete"}),(0,r.jsx)(n.td,{children:"not"}),(0,r.jsx)(n.td,{children:"using"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"distinct"}),(0,r.jsx)(n.td,{children:"null"}),(0,r.jsx)(n.td,{children:"values"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"drop"}),(0,r.jsx)(n.td,{children:"of"}),(0,r.jsx)(n.td,{children:"view"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"else"}),(0,r.jsx)(n.td,{children:"on"}),(0,r.jsx)(n.td,{children:"when"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"exists"}),(0,r.jsx)(n.td,{children:"or"}),(0,r.jsx)(n.td,{children:"whenever"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"false"}),(0,r.jsx)(n.td,{children:"order"}),(0,r.jsx)(n.td,{children:"where"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"following"}),(0,r.jsx)(n.td,{children:"organization"}),(0,r.jsx)(n.td,{children:"with"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"for"}),(0,r.jsx)(n.td,{}),(0,r.jsx)(n.td,{})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);
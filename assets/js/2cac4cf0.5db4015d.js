"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[939],{11430:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/materialize-iceberg-lf-application-integration-1df0ec59d791fa32f5bdb4692b401904.png"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},62953:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"reference/Connectors/materialization-connectors/apache-iceberg","title":"Apache Iceberg","description":"This connector materializes Flow collections into Iceberg tables. It","source":"@site/docs/reference/Connectors/materialization-connectors/apache-iceberg.md","sourceDirName":"reference/Connectors/materialization-connectors","slug":"/reference/Connectors/materialization-connectors/apache-iceberg","permalink":"/reference/Connectors/materialization-connectors/apache-iceberg","draft":false,"unlisted":false,"editUrl":"https://github.com/estuary/flow/edit/master/site/docs/reference/Connectors/materialization-connectors/apache-iceberg.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Apache Parquet Files in Amazon S3","permalink":"/reference/Connectors/materialization-connectors/amazon-s3-parquet"},"next":{"title":"Apache Kafka","permalink":"/reference/Connectors/materialization-connectors/apache-kafka"}}');var r=t(74848),i=t(28453);const a={},c="Apache Iceberg",o={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Iceberg Catalog",id:"iceberg-catalog",level:2},{value:"Using AWS Glue as an Iceberg Catalog",id:"using-aws-glue-as-an-iceberg-catalog",level:3},{value:"AWS Glue with Lake Formation",id:"aws-glue-with-lake-formation",level:4},{value:"S3 Table Buckets",id:"s3-table-buckets",level:3},{value:"Using Other REST Catalogs",id:"using-other-rest-catalogs",level:3},{value:"Example: Snowflake Open Catalog",id:"example-snowflake-open-catalog",level:4},{value:"AWS EMR Serverless Application Configuration",id:"aws-emr-serverless-application-configuration",level:2},{value:"Create the AWS EMR Serverless Application",id:"create-the-aws-emr-serverless-application",level:3},{value:"Configure Parameter Store",id:"configure-parameter-store",level:3},{value:"Create Staging Bucket",id:"create-staging-bucket",level:3},{value:"Create IAM Role for EMR Execution",id:"create-iam-role-for-emr-execution",level:3},{value:"Create IAM User for Compute Configuration",id:"create-iam-user-for-compute-configuration",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Properties",id:"properties",level:3},{value:"Endpoint",id:"endpoint",level:4},{value:"Bindings",id:"bindings",level:4},{value:"Sync Schedule",id:"sync-schedule",level:2},{value:"Iceberg Column Types",id:"iceberg-column-types",level:2},{value:"Table Maintenance",id:"table-maintenance",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"apache-iceberg",children:"Apache Iceberg"})}),"\n",(0,r.jsx)(n.p,{children:"This connector materializes Flow collections into Iceberg tables. It\norchestrates Spark jobs running on your configured compute system to merge\nupdates into materialized tables as new data is available in the source\ncollections."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://ghcr.io/estuary/materialize-iceberg:dev",children:(0,r.jsx)(n.code,{children:"ghcr.io/estuary/materialize-iceberg:dev"})}),"\nprovides the latest connector image. You can also follow the link in your\nbrowser to see past image versions."]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"To use this connector, you'll need:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["An Iceberg catalog that implements the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/iceberg/blob/main/open-api/rest-catalog-open-api.yaml",children:"Apache Iceberg REST Catalog\nAPI"})]}),"\n",(0,r.jsxs)(n.li,{children:["An ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/emr/latest/EMR-Serverless-UserGuide/emr-serverless.html",children:"AWS EMR Serverless\nApplication"}),"\nwith the Spark runtime"]}),"\n",(0,r.jsx)(n.li,{children:"An S3 bucket for staging data files to be merged into tables"}),"\n",(0,r.jsx)(n.li,{children:"A dedicated IAM role for executing jobs on the EMR Serverless Application"}),"\n",(0,r.jsx)(n.li,{children:"An AWS IAM user for submitting jobs to the EMR Serverless Application"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"See below for detailed descriptions of how these should be set up."}),"\n",(0,r.jsx)(n.h2,{id:"iceberg-catalog",children:"Iceberg Catalog"}),"\n",(0,r.jsx)(n.h3,{id:"using-aws-glue-as-an-iceberg-catalog",children:"Using AWS Glue as an Iceberg Catalog"}),"\n",(0,r.jsxs)(n.p,{children:["AWS Glue Catalogs are supported by way of the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/glue/latest/dg/connect-glu-iceberg-rest.html",children:"AWS Glue Iceberg REST\nendpoint"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Note the following connector configuration details when using AWS Glue as the\ncatalog:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"Base URL"})," for the catalog should be\n",(0,r.jsx)(n.code,{children:"https://glue.<region>.amazonaws.com/iceberg"}),", where ",(0,r.jsx)(n.code,{children:"<region>"})," is the AWS\nregion of the catalog","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Example: ",(0,r.jsx)(n.code,{children:"https://glue.us-east-2.amazonaws.com/iceberg"})," for a Glue catalog\nin ",(0,r.jsx)(n.code,{children:"us-east-2"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"Warehouse"})," is your AWS Account ID, without hyphens","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Example: If your AWS Account ID is ",(0,r.jsx)(n.code,{children:"0123-4567-8901"}),", the ",(0,r.jsx)(n.strong,{children:"Warehouse"})," is\n",(0,r.jsx)(n.code,{children:"012345678901"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Base Location"})," is required. This is the base location of where table data\nand metadata will be stored, by default under ",(0,r.jsx)(n.code,{children:"/data"})," and ",(0,r.jsx)(n.code,{children:"/metadata"}),",\nrespectively. It must be an S3 path starting with ",(0,r.jsx)(n.code,{children:"s3://<bucket>"}),". For other\nREST catalogs, this is an optional input"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"AWS SigV4 Authentication"})," for the ",(0,r.jsx)(n.strong,{children:"Catalog Authentication"})," option,\nwith the ",(0,r.jsx)(n.strong,{children:"Signing Name"})," ",(0,r.jsx)(n.code,{children:"glue"}),". Input the ",(0,r.jsx)(n.strong,{children:"AWS Access Key ID"})," and ",(0,r.jsx)(n.strong,{children:"AWS\nSecret Access Key"})," for an AWS IAM user that has been granted sufficient\npermissions to read and write metadata to the catalog. See below for an\nexample policy that includes the minimum required permissions to interact with\nthe Glue catalog and bucket containing table metadata."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Sid": "GlueIcebergCatalogAccess",\n      "Effect": "Allow",\n      "Action": [\n        "glue:GetCatalog",\n        "glue:GetDatabases",\n        "glue:CreateTable",\n        "glue:GetTables",\n        "glue:CreateDatabase",\n        "glue:UpdateTable",\n        "glue:DeleteTable",\n        "glue:GetTable"\n      ],\n      "Resource": [\n        "arn:aws:glue:<region>:<aws-account-id>:*"\n      ]\n    },\n    {\n      "Sid": "TableBucketAccess",\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:ListBucket",\n        "s3:DeleteObject"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<table-bucket>",\n        "arn:aws:s3:::<table-bucket>/*"\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["The AWS IAM user configured for the ",(0,r.jsx)(n.strong,{children:"Catalog Authentication"})," does not\nnecessarily need to be the same user as the one configured to access the AWS EMR\nServerless Application, but it can be. Enter the same ",(0,r.jsx)(n.strong,{children:"AWS Access Key ID"})," and\n",(0,r.jsx)(n.strong,{children:"AWS Secret Access Key"})," in both places if you are using the same user."]})}),"\n",(0,r.jsx)(n.h4,{id:"aws-glue-with-lake-formation",children:"AWS Glue with Lake Formation"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/lake-formation/latest/dg/what-is-lake-formation.html",children:"AWS Lake\nFormation"}),"\nprovides an additional layer of permissions that apply after IAM policy\npermissions. If you are using AWS Lake Formation to manage access to your Glue\ncatalog, additional setup is required to grant the necessary access."]}),"\n",(0,r.jsxs)(n.p,{children:["The following instructions assume Lake Formation is enabled, and that the bucket\nlocation you are using to store Iceberg table data is a registered location in\nLake Formation. Reference the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/lake-formation/latest/dg/lf-permissions-reference.html",children:"AWS Lake Formation Developer\nGuide"}),"\nfor comprehensive instructions for adding Lake Formation permissions. Specific\npermissions and sample AWS CLI commands for this connector are shown below,\nwhere applicable."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure that the registered location is ",(0,r.jsx)(n.em,{children:"not"})," using the default service-linked\nrole (",(0,r.jsx)(n.code,{children:"AWSServiceRoleForLakeFormationDataAccess"}),"). You must create a ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/lake-formation/latest/dg/registration-role.html",children:"custom\nrole"}),"\nfor registering the location. At a minimum, the role must have an inline\npolicy granting access to the registered bucket, as well as a trust\nrelationship with the ",(0,r.jsx)(n.code,{children:"lakeformation.amazonaws.com"})," entity. An example inline\nbucket access policy and trust policy are below:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Sid": "LakeFormationRegisteredLocationBucketAccessPolicy",\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:ListBucket",\n        "s3:DeleteObject"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<table-bucket>",\n        "arn:aws:s3:::<table-bucket>/*"\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Sid": "LakeFormationRegisteredLocationTrustPolicy",\n            "Effect": "Allow",\n            "Principal": {\n                "Service": "lakeformation.amazonaws.com"\n            },\n            "Action": "sts:AssumeRole"\n        }\n    ]\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Give the ",(0,r.jsx)(n.code,{children:"lakeformation:GetDataAccess"})," permission to the configured catalog\nuser, for example by attaching a policy to the user like this:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": "lakeformation:GetDataAccess",\n      "Resource": "*"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the Lake Formation console, under ",(0,r.jsx)(n.strong,{children:"Administration -> Application\nintegration settings"}),", ensure ",(0,r.jsx)(n.strong,{children:"Allow external engines to access data in\nAmazon S3 locations with full table access"})," is ",(0,r.jsx)(n.strong,{children:"enabled"})," by checking the\nbox for it.\n",(0,r.jsx)(n.img,{alt:"Configuring Lake Formation application integration settings",src:t(11430).A+"",width:"1640",height:"686"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Grant ",(0,r.jsx)(n.code,{children:"DATA_LOCATION_ACCESS"})," to the registered location for the catalog user:"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'aws lakeformation grant-permissions \\\n  --principal DataLakePrincipalIdentifier=<catalog-user-arn> \\\n  --permissions "DATA_LOCATION_ACCESS" \\\n  --resource \'{"DataLocation":{"CatalogId":"<aws-account-id>","ResourceArn":"<registered-bucket-arn>"}}\'\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["Grant ",(0,r.jsx)(n.code,{children:"CREATE_DATABASE"})," on the catalog for the catalog user:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'aws lakeformation grant-permissions \\\n  --principal DataLakePrincipalIdentifier=<catalog-user-arn> \\\n  --permissions "CREATE_DATABASE" \\\n  --resource \'{ "Catalog": {"Id": "<aws-account-id>"} }\'\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["Grant ",(0,r.jsx)(n.code,{children:"ALL"})," access to tables within any pre-existing databases that will\ncontain materialized tables to the catalog user. Databases the connector\ncreates will automatically have the necessary permissions for the catalog\nuser. Run this command for each pre-existing database that matches a\nnamespace of a binding configured in the materialization:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'aws lakeformation grant-permissions \\\n  --principal DataLakePrincipalIdentifier=<catalog-user-arn> \\\n  --permissions "ALL" \\\n  --resource \'{ "Table": {"DatabaseName":"<database-name>", "TableWildcard":{}}}\'\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsxs)(n.li,{children:["Grant ",(0,r.jsx)(n.code,{children:"ALL"})," access to ",(0,r.jsx)(n.em,{children:"all"})," databases that will contain materialized tables\nto the EMR Execution Role. You may need to do this step after the connector\nhas automatically created the databases for the role to have the required\naccess. Run this command for each database:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'aws lakeformation grant-permissions \\\n  --principal DataLakePrincipalIdentifier=<emr-execution-role-arn> \\\n  --permissions "ALL" \\\n  --resource \'{ "Table": {"DatabaseName":"<database-name>", "TableWildcard":{}}}\'\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["If you have enabled\n",(0,r.jsx)(n.a,{href:"/concepts/materialization#using-sourcecapture-to-synchronize-capture-and-materialization-bindings",children:"sourceCapture"}),"\nfor your materialization and a new binding is added with a new namespace, you\nwill need the repeat step 7 to grant access to that database to the EMR\nexecution role."]})}),"\n",(0,r.jsx)(n.h3,{id:"s3-table-buckets",children:"S3 Table Buckets"}),"\n",(0,r.jsxs)(n.p,{children:["You can materialize to S3 table buckets using the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-tables-integrating-glue-endpoint.html",children:"AWS Glue Iceberg Rest\nEndpoint"}),"\nif your S3 tables are integrated with the Glue data catalog, or directly using\nthe ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-tables-integrating-open-source.html",children:"S3 Tables Iceberg REST\nEndpoint"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"important",children:(0,r.jsx)(n.p,{children:'If you plan to query your S3 table buckets using AWS analytics services such as\nAmazon Athena, all table column names must be lowercase. You should enable the\nadvanced option "Lowercase Column Names" in the materialization configuration if\nyour source collection has fields with capital letters in their names to ensure\nall columns are created as lowercase.'})}),"\n",(0,r.jsx)(n.p,{children:"To configure the materialization to connect directly to the S3 Tables Iceberg REST Endpoint:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"Base URL"})," for the catalog should be\n",(0,r.jsx)(n.code,{children:"https://s3tables.<region>.amazonaws.com/iceberg"}),", where ",(0,r.jsx)(n.code,{children:"<region>"})," is the AWS\nregion of the bucket"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"Warehouse"})," is the table bucket ARN, in the form of\n",(0,r.jsx)(n.code,{children:"arn:aws:s3tables:<region>:<accountID>:bucket/<bucketname>"})]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"AWS SigV4 Authentication"})," for the ",(0,r.jsx)(n.strong,{children:"Catalog Authentication"})," option,\nwith the ",(0,r.jsx)(n.strong,{children:"Signing Name"})," ",(0,r.jsx)(n.code,{children:"s3tables"}),". Input the ",(0,r.jsx)(n.strong,{children:"AWS Access Key ID"})," and\n",(0,r.jsx)(n.strong,{children:"AWS Secret Access Key"})," for an AWS IAM user that has been granted sufficient\npermissions to read and write to the bucket."]}),"\n",(0,r.jsxs)(n.li,{children:["Your ",(0,r.jsx)(n.strong,{children:"EMR Execution Role"})," must also have been granted sufficient permissions\nto read and write to the bucket. See below for an example policy with the\nnecessary permission for both the AWS IAM user and the execution role"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Sid": "S3TablesAccess",\n            "Effect": "Allow",\n            "Action": [\n                "s3tables:GetTableBucket",\n                "s3tables:ListNamespaces",\n                "s3tables:CreateNamespace",\n                "s3tables:ListTables",\n                "s3tables:CreateTable",\n                "s3tables:PutTableData",\n                "s3tables:GetTableData",\n                "s3tables:UpdateTableMetadataLocation",\n                "s3tables:GetTableMetadataLocation",\n                "s3tables:DeleteTable"\n            ],\n            "Resource": [\n                "arn:aws:s3tables:<region>:<aws-account-id>:bucket/<bucket>",\n                "arn:aws:s3tables:<region>:<aws-account-id>:bucket/<bucket>/*"\n            ]\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"using-other-rest-catalogs",children:"Using Other REST Catalogs"}),"\n",(0,r.jsxs)(n.p,{children:["Configuration for REST catalogs other than AWS Glue will depend on the specific\ncatalog. These catalogs should use ",(0,r.jsx)(n.strong,{children:"OAuth 2.0 Client Credentials"})," for the\n",(0,r.jsx)(n.strong,{children:"Catalog Authentication"})," configuration."]}),"\n",(0,r.jsx)(n.admonition,{title:"Beta",type:"info",children:(0,r.jsx)(n.p,{children:"Currently only REST catalogs that use Amazon S3 for external cloud storage are\nsupported. Support for catalogs backed by GCP or Azure is planned."})}),"\n",(0,r.jsx)(n.h4,{id:"example-snowflake-open-catalog",children:"Example: Snowflake Open Catalog"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://www.snowflake.com/en/product/features/open-catalog/",children:"Snowflake Open\nCatalog"})," is a\nmanaged Iceberg REST catalog service. Refer to the\n",(0,r.jsx)(n.a,{href:"https://other-docs.snowflake.com/en/opencatalog/overview",children:"docs"})," for detailed\ninformation on how to set it up. These are the high-level steps that must be\ncompleted:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create external cloud storage for the catalog. This is where table data and\nmetadata files are stored"}),"\n",(0,r.jsx)(n.li,{children:"Create the catalog and permissions for Snowflake Open Catalog to access your\ncloud storage"}),"\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.strong,{children:"Role"})," for the catalog, and grant it these permissions:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"CATALOG_MANAGE_CONTENT"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"CATALOG_MANAGE_METADATA"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"CATALOG_READ_PROPERTIES"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"CATALOG_WRITE_PROPERTIES"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NAMESPACE_CREATE"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NAMESPACE_FULL_METADATA"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NAMESPACE_LIST"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NAMESPACE_READ_PROPERTIES"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NAMESPACE_WRITE_PROPERTIES"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_CREATE"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_DROP"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_FULL_METADATA"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_LIST"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_READ_DATA"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_READ_PROPERTIES"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_WRITE_DATA"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"TABLE_WRITE_PROPERTIES"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.strong,{children:"Service Connection"})," and ",(0,r.jsx)(n.strong,{children:"Principal Role"}),". When creating the\nservice connection, the input for ",(0,r.jsx)(n.strong,{children:"Query Engine"})," can be left blank, or set\nto anything you want. Copy the ",(0,r.jsx)(n.strong,{children:"Client ID"})," and ",(0,r.jsx)(n.strong,{children:"Client Secret"})," when they\nare shown to you. You will need this credential when setting up the\nmaterialization's ",(0,r.jsx)(n.strong,{children:"Catalog Credential"}),", as ",(0,r.jsx)(n.code,{children:"<client id>:<client secret>"})]}),"\n",(0,r.jsxs)(n.li,{children:["Grant the ",(0,r.jsx)(n.strong,{children:"Role"})," you created in the catalog to the ",(0,r.jsx)(n.strong,{children:"Principal Role"})," you\njust created"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Now you can configure the materialization:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.strong,{children:"Base URL"})," should be ",(0,r.jsx)(n.code,{children:"https://<open_catalog_account_identifier>.snowflakecomputing.com/polaris/api/catalog"})]}),"\n",(0,r.jsxs)(n.li,{children:["For ",(0,r.jsx)(n.strong,{children:"Warehouse"}),", use the name of the Snowflake Open Catalog."]}),"\n",(0,r.jsxs)(n.li,{children:["Enter any ",(0,r.jsx)(n.strong,{children:"Namespace"})," you desire. It will be created if it does not already\nexist"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Base Location"})," can be left blank to use the default base location you\nspecified when creating the Snowflake Open Catalog"]}),"\n",(0,r.jsxs)(n.li,{children:["For ",(0,r.jsx)(n.strong,{children:"Catalog Authentication"}),", select ",(0,r.jsx)(n.strong,{children:"OAuth 2.0 Client Credentials"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use the default ",(0,r.jsx)(n.code,{children:"v1/oauth/tokens"})," for ",(0,r.jsx)(n.code,{children:"OAuth 2.0 Server URI"})]}),"\n",(0,r.jsxs)(n.li,{children:["Input the ",(0,r.jsx)(n.strong,{children:"Catalog Credential"})," you copied when creating the ",(0,r.jsx)(n.strong,{children:"Service\nConnection"})]}),"\n",(0,r.jsxs)(n.li,{children:["Set the ",(0,r.jsx)(n.strong,{children:"Scope"})," as ",(0,r.jsx)(n.code,{children:"PRINCIPAL_ROLE:<your_principal>"}),", where\n",(0,r.jsx)(n.code,{children:"<your_principal>"})," is the name of the ",(0,r.jsx)(n.strong,{children:"Principal Role"})," you created when\ncreating the ",(0,r.jsx)(n.strong,{children:"Service Connection"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["You can specify the ",(0,r.jsx)(n.code,{children:"<open_catalog_account_identifier>"})," in the ",(0,r.jsx)(n.strong,{children:"Base URL"}),"\nabove as ",(0,r.jsx)(n.code,{children:"<account name>.<cloud region>.<cloud provider>"}),". See the\n",(0,r.jsx)(n.a,{href:"https://other-docs.snowflake.com/en/opencatalog/find-account-name",children:"docs"})," for\nhow to find your account name. The ",(0,r.jsx)(n.code,{children:"cloud region"})," and ",(0,r.jsx)(n.code,{children:"cloud provider"})," are for\nthe Snowflake Open Catalog, and are found in the same place as the account name.\nFor example, if your account name is ",(0,r.jsx)(n.code,{children:"ab12345"})," on ",(0,r.jsx)(n.code,{children:"us-east-2.aws"}),", your ",(0,r.jsx)(n.strong,{children:"Base\nURL"})," will be\n",(0,r.jsx)(n.code,{children:"https://ab12345.us-east-2.aws.snowflakecomputing.com/polaris/api/catalog"}),"."]})}),"\n",(0,r.jsx)(n.h2,{id:"aws-emr-serverless-application-configuration",children:"AWS EMR Serverless Application Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["To use ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/emr/latest/EMR-Serverless-UserGuide/emr-serverless.html",children:"AWS EMR\nServerless"}),"\nfor compute, a few different AWS items must be set up to work together:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The connector submits jobs to the ",(0,r.jsx)(n.strong,{children:"AWS EMR Serverless Application"})," and\nmonitors their progress"]}),"\n",(0,r.jsxs)(n.li,{children:["Catalog credentials are stored securely in ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html",children:"AWS Systems Manager Parameter\nStore"}),",\nmanaged by the connector, and read by EMR jobs to connect to the catalog"]}),"\n",(0,r.jsx)(n.li,{children:"Data to merge into tables is staged in an S3 bucket and read by EMR jobs"}),"\n",(0,r.jsxs)(n.li,{children:["EMR jobs are run using an IAM role with a specific ",(0,r.jsx)(n.strong,{children:"Execution Role ARN"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"create-the-aws-emr-serverless-application",children:"Create the AWS EMR Serverless Application"}),"\n",(0,r.jsxs)(n.p,{children:["General documentation for creating a new AWS EMR Serverless Application is\navailable\n",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/emr/latest/EMR-Serverless-UserGuide/gs-console.html#gs-application-console",children:"here"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Note the following specific details when creating the application to use with\nthis connector:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.strong,{children:"Spark"})," for the ",(0,r.jsx)(n.strong,{children:"Type"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"emr-7.7.0"})," for the ",(0,r.jsx)(n.strong,{children:"Release Version"}),", and ",(0,r.jsx)(n.strong,{children:"x86_64"})," for the\n",(0,r.jsx)(n.strong,{children:"Architecture"})]}),"\n",(0,r.jsxs)(n.li,{children:["For ",(0,r.jsx)(n.strong,{children:"Application setup options"}),", select ",(0,r.jsx)(n.strong,{children:"Use custom settings"}),". These options\ncan generally be configured as desired, with the specific notes below:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pre-initialized capacity"})," is not required, but may help reduce latency for\nstreaming updates"]}),"\n",(0,r.jsxs)(n.li,{children:["In ",(0,r.jsx)(n.strong,{children:"Additional configurations"})," there is an option for ",(0,r.jsx)(n.strong,{children:"Use AWS Glue Data\nCatalog as metastore"}),". This is not required, even if you are using AWS Glue\nas your Iceberg catalog"]}),"\n",(0,r.jsxs)(n.li,{children:["Make sure ",(0,r.jsx)(n.strong,{children:"Automatically start application on job submission"})," is enabled\nunder ",(0,r.jsx)(n.strong,{children:"Application behavior"}),". Enabling ",(0,r.jsx)(n.strong,{children:"Automatically stop after\napplication is idle for"})," is recommended to stop any pre-initialized capacity\nduring periods of low data volume"]}),"\n",(0,r.jsxs)(n.li,{children:["In ",(0,r.jsx)(n.strong,{children:"Network connections"}),", you must configure ",(0,r.jsx)(n.strong,{children:"Virtual private cloud\n(VPC)"}),", ",(0,r.jsx)(n.strong,{children:"Subnets"}),", and ",(0,r.jsx)(n.strong,{children:"Security groups"}),"  to enable REST API calls to\nyour Iceberg catalog. The subnets must have a route to an Internet Gateway,\nand the security group must allow outbound traffic. See the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/emr/latest/EMR-Serverless-UserGuide/vpc-access.html",children:"AWS\ndocs"}),"\nfor setting up VPC access for EMR Serverless applications"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configure-parameter-store",children:"Configure Parameter Store"}),"\n",(0,r.jsx)(n.p,{children:"AWS Systems Manager Parameter Store requires minimal additional configuration.\nCatalog credentials are stored encrypted in parameter store by the connector,\nand retrieved by EMR Serverless jobs to connect to your catalog."}),"\n",(0,r.jsxs)(n.p,{children:["Parameter Store is only used with ",(0,r.jsx)(n.strong,{children:"OAuth 2.0 Client Credentials"}),". If you are\nusing AWS Glue as your catalog, the ",(0,r.jsx)(n.strong,{children:"Systems Manager Prefix"})," can be left\nblank, since the EMR execution role will have permissions to read from the\ncatalog associated with it directly. The ",(0,r.jsx)(n.strong,{children:"Systems Manager Prefix"})," is a\nhierarchical location where the connector will store encrypted credentials. For\nexample, you may input ",(0,r.jsx)(n.code,{children:"/estuary/"})," as the prefix - note the leading a trailing\nslashes are required."]}),"\n",(0,r.jsx)(n.h3,{id:"create-staging-bucket",children:"Create Staging Bucket"}),"\n",(0,r.jsxs)(n.p,{children:["Data to merge into Iceberg tables is staged in an S3 bucket under the optional\n",(0,r.jsx)(n.strong,{children:"Bucket Path"})," prefix by the connector. Additional connector metadata is stored\nin the staging bucket under the ",(0,r.jsx)(n.code,{children:"flow_metadata_v1"})," prefix. The staging bucket\nmust be in the same region as the EMR application."]}),"\n",(0,r.jsx)(n.h3,{id:"create-iam-role-for-emr-execution",children:"Create IAM Role for EMR Execution"}),"\n",(0,r.jsx)(n.p,{children:"This role must have sufficient permissions to read credentials from Systems\nManager (unless you are using Glue), and access data in the staging bucket. If\nyou are using AWS Glue as the catalog, this role must also have permissions to\naccess the catalog."}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/emr/latest/EMR-Serverless-UserGuide/getting-started.html#gs-runtime-role",children:"AWS\ndocs"}),"\nfor information on how to create the role."]}),"\n",(0,r.jsxs)(n.p,{children:["You must include this ",(0,r.jsx)(n.strong,{children:"Custom trust policy"})," for the role type when creating\nthe role in order for jobs submitted to the application to access other AWS\nservices on behalf of the IAM user:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Principal": {\n        "Service": "emr-serverless.amazonaws.com"\n      },\n      "Action": "sts:AssumeRole"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"See below for an example policy with the required permissions to attach to the\nexecution role if you are using a standard REST catalog:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Sid": "StagingBucketAccess",\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:ListBucket",\n        "s3:DeleteObject"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<staging-bucket>/<optional-bucket-path>",\n        "arn:aws:s3:::<staging-bucket>/<optional-bucket-path>/*"\n      ]\n    },\n    {\n      "Sid": "ParameterStoreAccess",\n      "Effect": "Allow",\n      "Action": [\n        "ssm:GetParameter"\n      ],\n      "Resource": "arn:aws:ssm:<region>:<aws-account-id>:parameter/<systems-manager-prefix>/*"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"If you are using a Glue catalog, Parameter Store access is not required, but\naccess to the Glue catalog is, as well as access to the bucket where Glue stores\nthe table files:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Sid": "StagingBucketAccess",\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:ListBucket",\n        "s3:DeleteObject"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<staging-bucket>/<optional-bucket-path>",\n        "arn:aws:s3:::<staging-bucket>/<optional-bucket-path>/*"\n      ]\n    },\n    {\n      "Sid": "TableBucketAccess",\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:ListBucket",\n        "s3:DeleteObject"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<table-bucket>",\n        "arn:aws:s3:::<table-bucket>/*"\n      ]\n    },\n    {\n      "Sid": "GlueCatalogTableModification",\n      "Effect": "Allow",\n      "Action": [\n        "glue:GetTable",\n        "glue:UpdateTable"\n      ],\n      "Resource": [\n        "arn:aws:glue:<region>:<aws-account-id>:*"\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"create-iam-user-for-compute-configuration",children:"Create IAM User for Compute Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"AWS Access Key ID"})," and ",(0,r.jsx)(n.strong,{children:"AWS Secret Access Key"})," set in the ",(0,r.jsx)(n.strong,{children:"AWS EMR\nServerless"})," configuration must be for an IAM user with permissions to manage\njobs for the EMR Serverless Application and read and write data to the staging\nbucket. If you are using AWS Glue as the catalog, parameter store permissions\nare not required."]}),"\n",(0,r.jsx)(n.p,{children:"See below for an example policy with these permissions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Sid": "StagingBucketAccess",\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:ListBucket",\n        "s3:DeleteObject"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<staging-bucket>/<optional-bucket-path>",\n        "arn:aws:s3:::<staging-bucket>/<optional-bucket-path>/*"\n      ]\n    },\n    {\n      "Effect": "Allow",\n      "Action": "iam:PassRole",\n      "Resource": "<emr-execution-role-arn>",\n      "Condition": {\n        "StringEquals": {\n          "iam:PassedToService": "emr-serverless.amazonaws.com"\n        }\n      }\n    },\n    {\n      "Sid": "EMRServerlessActions",\n      "Effect": "Allow",\n      "Action": [\n        "emr-serverless:ListApplications",\n        "emr-serverless:GetApplication",\n        "emr-serverless:StartApplication",\n        "emr-serverless:StartJobRun",\n        "emr-serverless:CancelJobRun",\n        "emr-serverless:ListJobRuns",\n        "emr-serverless:GetJobRun"\n      ],\n      "Resource": [\n        "arn:aws:emr-serverless:<region>:<aws-account-id>:/applications/<emr-application-id>",\n        "arn:aws:emr-serverless:<region>:<aws-account-id>:/applications/<emr-application-id>/jobruns/*"\n      ]\n    },\n    {\n      "Sid": "ParameterStoreAccess",\n      "Effect": "Allow",\n      "Action": [\n        "ssm:PutParameter",\n        "ssm:GetParameter"\n      ],\n      "Resource": "arn:aws:ssm:<region>:<aws-account-id>:parameter/<systems-manager-prefix>/*"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"See below for a full list of configuration options."}),"\n",(0,r.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(n.h4,{id:"endpoint",children:"Endpoint"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Title"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required/Default"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/url"})})}),(0,r.jsx)(n.td,{children:"URL"}),(0,r.jsx)(n.td,{children:"Base URL for the catalog."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/warehouse"})})}),(0,r.jsx)(n.td,{children:"Warehouse"}),(0,r.jsx)(n.td,{children:"Warehouse to connect to. For AWS Glue, this is the account ID."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/namespace"})})}),(0,r.jsx)(n.td,{children:"Namespace"}),(0,r.jsx)(n.td,{children:"Namespace for bound collection tables (unless overridden within the binding resource configuration)."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:["Required (Pattern: ",(0,r.jsx)(n.code,{children:"^[^.]*$"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/base_location"})}),(0,r.jsx)(n.td,{children:"Base Location"}),(0,r.jsxs)(n.td,{children:["Base location for catalog tables. Required if using AWS Glue. Example: ",(0,r.jsx)(n.code,{children:"s3://your_bucket/your_prefix/"}),"."]}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/hard_delete"})}),(0,r.jsx)(n.td,{children:"Hard Delete"}),(0,r.jsx)(n.td,{children:"If enabled, items deleted in the source will also be deleted from the destination. Disabled by default (soft-delete)."}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication"})})}),(0,r.jsx)(n.td,{children:"Catalog Authentication"}),(0,r.jsx)(n.td,{children:"Authentication method for the catalog. Supports OAuth 2.0 Client Credentials or AWS SigV4."}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/oauth2_server_uri"})})}),(0,r.jsx)(n.td,{children:"OAuth 2.0 Server URI"}),(0,r.jsx)(n.td,{children:"OAuth 2.0 server URI for requesting access tokens. Usually 'v1/oauth/tokens'."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/credential"})})}),(0,r.jsx)(n.td,{children:"Catalog Credential"}),(0,r.jsxs)(n.td,{children:["Credential for connecting to the REST catalog. Format: ",(0,r.jsx)(n.code,{children:"<client_id>:<client_secret>"})," for OAuth, ",(0,r.jsx)(n.code,{children:"<token>"})," for Bearer authentication."]}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/scope"})}),(0,r.jsx)(n.td,{children:"Scope"}),(0,r.jsxs)(n.td,{children:["Authorization scope for OAuth client credentials. Example: ",(0,r.jsx)(n.code,{children:"PRINCIPAL_ROLE:your_principal"}),"."]}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/aws_access_key_id"})})}),(0,r.jsx)(n.td,{children:"AWS Access Key ID"}),(0,r.jsx)(n.td,{children:"Access Key ID for AWS SigV4 authentication."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/aws_secret_access_key"})})}),(0,r.jsx)(n.td,{children:"AWS Secret Access Key"}),(0,r.jsx)(n.td,{children:"Secret Access Key for AWS SigV4 authentication."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/region"})})}),(0,r.jsx)(n.td,{children:"Region"}),(0,r.jsx)(n.td,{children:"AWS region for authentication."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/catalog_authentication/signing_name"})})}),(0,r.jsx)(n.td,{children:"Signing Name"}),(0,r.jsx)(n.td,{children:"Signing Name for SigV4 authentication."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:["Required (",(0,r.jsx)(n.code,{children:"glue"})," or ",(0,r.jsx)(n.code,{children:"s3tables"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute"})})}),(0,r.jsx)(n.td,{children:"Compute"}),(0,r.jsx)(n.td,{children:"Compute backend for processing. Supports AWS EMR Serverless."}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute/aws_access_key_id"})})}),(0,r.jsx)(n.td,{children:"AWS Access Key ID"}),(0,r.jsx)(n.td,{children:"Access Key ID for authenticating with EMR and writing to the staging bucket."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute/aws_secret_access_key"})})}),(0,r.jsx)(n.td,{children:"AWS Secret Access Key"}),(0,r.jsx)(n.td,{children:"Secret Access Key for authenticating with EMR and writing to the staging bucket."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute/region"})})}),(0,r.jsx)(n.td,{children:"Region"}),(0,r.jsx)(n.td,{children:"Region of the EMR application and staging bucket."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute/application_id"})})}),(0,r.jsx)(n.td,{children:"Application ID"}),(0,r.jsx)(n.td,{children:"ID of the EMR serverless application."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute/execution_role_arn"})})}),(0,r.jsx)(n.td,{children:"Execution Role ARN"}),(0,r.jsx)(n.td,{children:"ARN of the EMR serverless execution role used to run jobs."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/compute/bucket"})})}),(0,r.jsx)(n.td,{children:"Bucket"}),(0,r.jsx)(n.td,{children:"Bucket to store staged data files."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/compute/bucket_path"})}),(0,r.jsx)(n.td,{children:"Bucket Path"}),(0,r.jsx)(n.td,{children:"Optional prefix used to store staged data files."}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/compute/systems_manager_prefix"})}),(0,r.jsx)(n.td,{children:"System Manager Prefix"}),(0,r.jsxs)(n.td,{children:["Prefix for parameters in Systems Manager as an absolute directory path (must start and end with ",(0,r.jsx)(n.code,{children:"/"}),")."]}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/estuary/"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/advanced/lowercase_column_names"})}),(0,r.jsx)(n.td,{children:"Lowercase Column Names"}),(0,r.jsx)(n.td,{children:"Create all columns with lowercase names."}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"bindings",children:"Bindings"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Title"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required/Default"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"/table"})})}),(0,r.jsx)(n.td,{children:"Table"}),(0,r.jsx)(n.td,{children:"Table name"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Required"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/namespace"})}),(0,r.jsx)(n.td,{children:"Alternative Namespace"}),(0,r.jsx)(n.td,{children:"Alternative namespace for this table"}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"sync-schedule",children:"Sync Schedule"}),"\n",(0,r.jsxs)(n.p,{children:["This connector supports configuring a schedule for sync frequency. You can read\nabout how to configure this ",(0,r.jsx)(n.a,{href:"/reference/materialization-sync-schedule",children:"here"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"iceberg-column-types",children:"Iceberg Column Types"}),"\n",(0,r.jsxs)(n.p,{children:["Flow collection fields are written to Iceberg table columns based on the data type of the field.\nIceberg ",(0,r.jsx)(n.a,{href:"https://iceberg.apache.org/spec/#primitive-types",children:"V2 primitive type"})," columns are created\nfor these Flow collection fields:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Collection Field Data Type"}),(0,r.jsx)(n.th,{children:"Iceberg Column Type"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"array"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"string"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"object"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"string"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"boolean"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"boolean"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"integer"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"long"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"number"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"double"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"string"})," with ",(0,r.jsx)(n.code,{children:"{contentEncoding: base64}"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"binary"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"string"})," with ",(0,r.jsx)(n.code,{children:"{format: date-time}"})]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"timestamptz"})," (with microsecond precision)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"string"})," with ",(0,r.jsx)(n.code,{children:"{format: date}"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"date"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"string"})," with ",(0,r.jsx)(n.code,{children:"{format: integer}"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"long"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"string"})," with ",(0,r.jsx)(n.code,{children:"{format: number}"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"double"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"string"})," (all others)"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"string"})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Flow collection fields with ",(0,r.jsx)(n.code,{children:"{type: string, format: time}"})," and ",(0,r.jsx)(n.code,{children:"{type: string, format: uuid}"})," are\nmaterialized as ",(0,r.jsx)(n.strong,{children:"string"})," columns rather than ",(0,r.jsx)(n.strong,{children:"time"})," and ",(0,r.jsx)(n.strong,{children:"uuid"})," columns for compatibility with\nApache Spark. ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://iceberg.apache.org/spec/#nested-types",children:"Nested types"})})," are not currently\nsupported."]}),"\n",(0,r.jsx)(n.h2,{id:"table-maintenance",children:"Table Maintenance"}),"\n",(0,r.jsxs)(n.p,{children:["To ensure optimal query performance, you should conduct ",(0,r.jsx)(n.a,{href:"https://iceberg.apache.org/docs/latest/maintenance/",children:"regular\nmaintenance"})," for your materialized tables since\nthe connector will not perform this maintenance automatically (support for automatic table\nmaintenance is planned)."]}),"\n",(0,r.jsxs)(n.p,{children:["If you're using the AWS Glue catalog, you can enable automatic data file compaction by following\n",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/lake-formation/latest/dg/data-compaction.html",children:"this guide"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);
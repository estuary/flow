<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/schema-evolution" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Schema Evolution | Estuary Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.estuary.dev/pr-preview/pr-2648/img/estuary-new.png"><meta data-rh="true" name="twitter:image" content="https://docs.estuary.dev/pr-preview/pr-2648/img/estuary-new.png"><meta data-rh="true" property="og:url" content="https://docs.estuary.dev/pr-preview/pr-2648/guides/schema-evolution/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Schema Evolution | Estuary Documentation"><meta data-rh="true" name="description" content="When collection specifications and schemas change, you must make corresponding changes in other parts of your Data Flow to avoid errors. In this guide, you&#x27;ll learn how to respond to different types of collection changes."><meta data-rh="true" property="og:description" content="When collection specifications and schemas change, you must make corresponding changes in other parts of your Data Flow to avoid errors. In this guide, you&#x27;ll learn how to respond to different types of collection changes."><link data-rh="true" rel="icon" href="/pr-preview/pr-2648/img/favicon-2.ico"><link data-rh="true" rel="canonical" href="https://docs.estuary.dev/pr-preview/pr-2648/guides/schema-evolution/"><link data-rh="true" rel="alternate" href="https://docs.estuary.dev/pr-preview/pr-2648/guides/schema-evolution/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.estuary.dev/pr-preview/pr-2648/guides/schema-evolution/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Using Estuary","item":"https://docs.estuary.dev/pr-preview/pr-2648/guides/"},{"@type":"ListItem","position":2,"name":"Schema Evolution","item":"https://docs.estuary.dev/pr-preview/pr-2648/guides/schema-evolution"}]}</script><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-WK8SB2L",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>
<script id="ai-widget-script" async src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="349e5b72-3e5a-4c19-8b7a-27c7b90caa0f" data-project-name="Estuary" data-modal-title="Estuary AI Assistant" data-project-color="#5072EB" data-button-text-color="#F2F2F2" data-project-logo="https://docs.estuary.dev/img/estuary-new.png" data-modal-example-questions-title="Try asking me..." data-modal-disclaimer="This AI assistant answers questions using Estuary&#39;s [documentation](https://docs.estuary.dev/), [blogs](https://estuary.dev/blog/), and additional resources. If you can&#39;t find your answer, join us on [Slack](https://go.estuary.dev/slack) or [send an email](https://estuary.dev/contact-us)." data-modal-example-questions="How does CDC work in Estuary?,How can I deploy to a private cloud?,How do I connect to PostgreSQL?,Is Estuary scalable?" data-uncertain-answer-callout="I may not have all of the information on that topic. I bet someone can answer it in [Slack](https://go.estuary.dev/slack)." data-mcp-enabled="true" data-mcp-server-url="https://estuary.mcp.kapa.ai"></script><link rel="stylesheet" href="/pr-preview/pr-2648/assets/css/styles.7c6c0a48.css">
<script src="/pr-preview/pr-2648/assets/js/runtime~main.31c1c94a.js" defer="defer"></script>
<script src="/pr-preview/pr-2648/assets/js/main.dd238433.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK8SB2L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pr-preview/pr-2648/"><div class="navbar__logo"><img src="/pr-preview/pr-2648/img/estuary-new.png" alt="Estuary Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/pr-preview/pr-2648/img/estuary-new.png" alt="Estuary Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Estuary</b></a><a aria-current="page" class="navbar__item navbar__link docs-section-link navbar__link--active" href="/pr-preview/pr-2648/">Platform</a><a class="navbar__item navbar__link docs-section-link" href="/pr-preview/pr-2648/reference/Connectors/">Connectors</a><div class="navbar__item"><a href="https://estuary.dev/blog" target="_blank">Blog</a></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://status.estuary.dev/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Status<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/estuary/flow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item button-link"><a href="https://dashboard.estuary.dev/register">Try Estuary</a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/pr-preview/pr-2648/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/pr-preview/pr-2648/guides/"><span title="Using Estuary" class="categoryLinkLabel_W154">Using Estuary</span></a><button aria-label="Collapse sidebar category &#x27;Using Estuary&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/guides/"><span title="Using Estuary" class="linkLabel_WmDU">Using Estuary</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/guides/create-dataflow/"><span title="Create a Basic Data Flow" class="linkLabel_WmDU">Create a Basic Data Flow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/guides/connect-network/"><span title="Secure Connections" class="linkLabel_WmDU">Secure Connections</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/reference/backfilling-data/"><span title="Backfilling Data" class="linkLabel_WmDU">Backfilling Data</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/pr-preview/pr-2648/guides/dashboard/"><span title="Estuary Dashboard" class="categoryLinkLabel_W154">Estuary Dashboard</span></a><button aria-label="Expand sidebar category &#x27;Estuary Dashboard&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/guides/get-started-with-flowctl/"><span title="Getting Started With flowctl" class="linkLabel_WmDU">Getting Started With flowctl</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/pr-preview/pr-2648/guides/flowctl/"><span title="Use flowctl" class="categoryLinkLabel_W154">Use flowctl</span></a><button aria-label="Expand sidebar category &#x27;Use flowctl&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/pr-preview/pr-2648/guides/customize-dataflows/"><span title="Customizing Data Flows" class="categoryLinkLabel_W154">Customizing Data Flows</span></a><button aria-label="Expand sidebar category &#x27;Customizing Data Flows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/pr-preview/pr-2648/guides/iam-auth/aws/"><span title="IAM Authentication" class="categoryLinkLabel_W154">IAM Authentication</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/pr-preview/pr-2648/guides/advanced-usage/metadata-fields/"><span title="Advanced Usage" class="categoryLinkLabel_W154">Advanced Usage</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/pr-preview/pr-2648/guides/troubleshooting/schema-inference-issues/"><span title="Troubleshooting" class="categoryLinkLabel_W154">Troubleshooting</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/reference/deletions/"><span title="Handling Deletions in Estuary" class="linkLabel_WmDU">Handling Deletions in Estuary</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pr-preview/pr-2648/guides/how_to_generate_refresh_token/"><span title="How to Generate an Estuary Refresh Token" class="linkLabel_WmDU">How to Generate an Estuary Refresh Token</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pr-preview/pr-2648/guides/schema-evolution/"><span title="Schema Evolution" class="linkLabel_WmDU">Schema Evolution</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/pr-preview/pr-2648/guides/dbt-integration/"><span title="Transforming Data" class="categoryLinkLabel_W154">Transforming Data</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/pr-preview/pr-2648/features/mcp-integration/"><span title="Advanced Features" class="categoryLinkLabel_W154">Advanced Features</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/pr-preview/pr-2648/concepts/"><span title="Concepts" class="categoryLinkLabel_W154">Concepts</span></a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/pr-preview/pr-2648/private-byoc/"><span title="Private &amp; BYOC Deployments" class="categoryLinkLabel_W154">Private &amp; BYOC Deployments</span></a><button aria-label="Expand sidebar category &#x27;Private &amp; BYOC Deployments&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/pr-preview/pr-2648/security/"><span title="Security &amp; Compliance" class="categoryLinkLabel_W154">Security &amp; Compliance</span></a><button aria-label="Expand sidebar category &#x27;Security &amp; Compliance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/pr-preview/pr-2648/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/pr-preview/pr-2648/guides/"><span>Using Estuary</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Schema Evolution</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Schema Evolution</h1></header>
<p>When collection specifications and schemas change, you must make corresponding changes in other parts of your Data Flow to avoid errors. In this guide, you&#x27;ll learn how to respond to different types of collection changes.</p>
<p>Manual methods (using flowctl) as well as features available in the Estuary web app are covered here.
For an in-depth overview of the automatic schema evolution feature in the web app and how it works, see <a class="" href="/pr-preview/pr-2648/concepts/advanced/evolutions/">this article</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction" translate="no">​</a></h2>
<p>Estuary <a class="" href="/pr-preview/pr-2648/concepts/collections/">collections</a> serve not only as your real-time data storage, but also as a contract between tasks that produce and consume their data. <strong>Captures</strong> are producers, <strong>materializations</strong> are consumers, and <strong>derivations</strong> can act as either.</p>
<p>This contract helps prevent data loss and error in your Data Flows, and is defined in terms of the collection specification, or spec, which includes:</p>
<ul>
<li class="">The JSON schema</li>
<li class="">The collection <code>key</code></li>
<li class=""><a class="" href="/pr-preview/pr-2648/concepts/advanced/projections/">Projections</a>, if any</li>
</ul>
<p>There are many reasons a collection spec might change. Often, it&#x27;s due to a change in the source data. Regardless, you&#x27;ll need to make changes to downstream tasks — most often, materializations — to avoid errors.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="schema-evolution-scenarios">Schema evolution scenarios<a href="#schema-evolution-scenarios" class="hash-link" aria-label="Direct link to Schema evolution scenarios" title="Direct link to Schema evolution scenarios" translate="no">​</a></h2>
<p>This guide is broken down into sections for different common scenarios, depending on which properties of the collection spec have changed.</p>
<ul>
<li class=""><a href="#re-creating-a-collection" class="">The <code>key</code> pointers have changed</a></li>
<li class=""><a href="#re-creating-a-collection" class="">The logical partitioning configuration has changed</a></li>
<li class="">The <code>schema</code> (or <code>readSchema</code> if defined separately) has changed<!-- -->
<ul>
<li class=""><a href="#a-new-field-is-added" class="">A new field is added</a></li>
<li class=""><a href="#a-fields-data-type-has-changed" class="">A field&#x27;s data type has changed</a></li>
<li class=""><a href="#a-field-was-removed" class="">A field was removed</a></li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>There are a variety of reasons why these properties may change, and also different mechanisms for detecting changes in source data. In general, it doesn&#x27;t matter why the collection spec has changed, only <em>what</em> has changed. However, <a class="" href="/pr-preview/pr-2648/concepts/captures/#automatically-update-captures">AutoDiscovers</a> are able to handle some of these scenarios automatically. Where applicable, AutoDiscover behavior will be called out under each section.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="re-creating-a-collection">Re-creating a collection<a href="#re-creating-a-collection" class="hash-link" aria-label="Direct link to Re-creating a collection" title="Direct link to Re-creating a collection" translate="no">​</a></h3>
<p><em>Scenario: the <code>key</code> pointer or logical partitioning configurations have changed.</em></p>
<p>The <code>key</code> of an Estuary collection cannot be changed after the collection is created. The same is true of the logical partitioning, which also cannot be changed after the collection is created.</p>
<p>If you need to change either of those parts of a collection spec, you&#x27;ll need to create a new collection and update the bindings of any captures or materializations that reference the old collection.</p>
<p><strong>Web app workflow</strong></p>
<p>If you&#x27;re working in the Estuary web app, you&#x27;ll see an error message and an option to re-create the collection as shown in the example below.</p>
<p><img decoding="async" loading="lazy" src="/pr-preview/pr-2648/assets/images/evolution-re-create-ui-d8ae2ab634980751f8c87a0483f96d39.png" width="2318" height="1215" class="img_ev3q"></p>
<p>Click <strong>Apply</strong> to re-create the collection and update any tasks that reference the old collection with the new name.</p>
<p><strong>flowctl workflow:</strong></p>
<p>If you&#x27;re working with flowctl, you&#x27;ll need to re-create the collection manually in your <code>flow.yaml</code> file. You must also update any captures or materializations that reference it. For example, say you have a data flow defined by the following specs:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">captures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/inventory/source-postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/estuary/source</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> encrypted</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pg</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.sops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">stream</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Normal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> acmeCo/inventory/anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">collections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/inventory/anvils</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">/sku</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sku</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">warehouse_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">quantity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> integer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">required</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sku</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> warehouse_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">materializations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/data-warehouse/materialize-snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/estuary/materialize</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> encrypted</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.sops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> acmeCo/inventory/anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> inventory</span><br></span></code></pre></div></div>
<p>To change the collection key, you would update the YAML like so. Note the capture <code>target</code>, collection name, and materialization <code>source</code>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">captures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/inventory/source-postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/estuary/source</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> encrypted</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pg</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.sops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">stream</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Normal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">backfill</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> acmeCo/inventory/anvils_v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">collections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/inventory/anvils_v2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">/sku</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sku</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">warehouse_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">quantity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> integer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">required</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sku</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> warehouse_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">materializations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/data-warehouse/materialize-snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/estuary/materialize</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> encrypted</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.sops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> acmeCo/inventory/anvils_v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">backfill</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> inventory</span><br></span></code></pre></div></div>
<p>The existing <code>acmeCo/inventory/anvils</code> collection will not be modified and will remain in place, but won&#x27;t update because no captures are writing to it.</p>
<p>Also note the addition of the <code>backfill</code> property. If the <code>backfill</code> property already exists, just increment its value. For the materialization, this will ensure that the destination table in Snowflake gets dropped and re-created, and that the materialization will backfill it from the beginning. In the capture, it similarly causes it to start over from the beginning, writing the captured data into the new collection.</p>
<p><strong>Auto-Discovers:</strong></p>
<p>If you enabled the option to <a class="" href="/pr-preview/pr-2648/concepts/captures/#automatically-update-captures"><strong>Automatically keep schemas up to date</strong> (<code>autoDiscover</code>)</a> and selected <strong>Breaking change re-versions collections</strong> (<code>evolveIncompatibleCollections</code>) for the capture, this evolution would be performed automatically.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="a-new-field-is-added">A new field is added<a href="#a-new-field-is-added" class="hash-link" aria-label="Direct link to A new field is added" title="Direct link to A new field is added" translate="no">​</a></h3>
<p><em>Scenario: this is one way in which the schema can change.</em></p>
<p>When a new field appears in the collection schema, it <em>may</em> automatically be added to any materializations that use <code>recommended</code> fields. Recommended fields are enabled by default in each binding. See <a class="" href="/pr-preview/pr-2648/concepts/materialization/#projected-fields">the materialization docs</a> for more info about how to enable or disable <code>recommended</code> fields.</p>
<p>When recommended fields are enabled, new fields are added automatically if they meet the criteria for the particular materialization connector. For example, scalar fields (strings, numbers, and booleans) are considered &quot;recommended&quot; fields when materializing to database tables.</p>
<p>If your materialization binding is set to <code>recommended: false</code>, or if the new field is not recommended, you can manually add it to the materialization.</p>
<p>To manually add a field:</p>
<ul>
<li class=""><strong>In the web app,</strong> <a class="" href="/pr-preview/pr-2648/guides/edit-data-flows/#edit-a-materialization">edit the materialization</a>, find the affected binding, and click <strong>Show Fields</strong>.</li>
<li class=""><strong>Using flowctl,</strong> add the field to <code>fields.include</code> in the materialization specification as shown <a class="" href="/pr-preview/pr-2648/concepts/materialization/#projected-fields">here</a>.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Newly added fields will not be set for rows that have already been materialized. If you want to ensure that all rows have the new field, just increment the <code>backfill</code> counter in the affected binding to have it re-start from the beginning.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="a-fields-data-type-has-changed">A field&#x27;s data type has changed<a href="#a-fields-data-type-has-changed" class="hash-link" aria-label="Direct link to A field&#x27;s data type has changed" title="Direct link to A field&#x27;s data type has changed" translate="no">​</a></h3>
<p><em>Scenario: this is one way in which the schema can change.</em></p>
<p>When a field&#x27;s data type has changed, the effect on your materialization depends on the specific connector you&#x27;re using.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Note that these restrictions only apply to fields that are actively being materialized. If a field is <a class="" href="/pr-preview/pr-2648/concepts/materialization/#projected-fields">excluded from your materialization</a>, either explicitly or because it&#x27;s not recommended, then the data types may change in any way.</p><p>Regardless of whether the field is materialized or not, it must still pass schema validation tests. Therefore, you must still make sure existing data remains valid against the new schema. For example, if you changed <code>excluded_field: { type: string }</code> to <code>type: integer</code> while there was existing data with string values, your materialization would fail due to a schema validation error.</p></div></div>
<p>Database and data warehouse materializations tend to be somewhat restrictive about changing column types. They typically only allow dropping <code>NOT NULL</code> constraints. This means that you can safely change a schema to make a required field optional, or to add <code>null</code> as a possible type, and the materialization will continue to work normally.  Most other types of changes will require materializing into a new table.</p>
<p>The best way to find out whether a change is acceptable to a given connector is to run a test or attempt to re-publish. Failed attempts to publish won&#x27;t affect any tasks that are already running.</p>
<p><strong>Web app workflow</strong></p>
<p>If you&#x27;re working in Estuary&#x27;s web app, and attempt to publish a change that&#x27;s unacceptable to the connector, you&#x27;ll see an error message and an offer to increment the necessary <code>backfill</code> counters, or, in rare cases, to re-create the collection.</p>
<p>Click <strong>Apply</strong> to to accept this solution and continue to publish.</p>
<p><strong>flowctl workflow</strong></p>
<p>If you test or attempt to publish a change that&#x27;s unacceptable to the connector, you&#x27;ll see an error message pointing to the field that&#x27;s changed. In most cases, you can work around the issue by manually updating the materialization to materialize into a new table.</p>
<p>For example, say you have a data flow defined by the following specs:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">collections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/inventory/anvils</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">/sku</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sku</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">quantity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> integer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">required</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sku</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">materializations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/data-warehouse/materialize-snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/estuary/materialize</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> encrypted</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.sops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> acmeCo/inventory/anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">backfill</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> inventory</span><br></span></code></pre></div></div>
<p>Let&#x27;s say the type of <code>description</code> was broadened to allow <code>object</code> values in addition to <code>string</code>. You&#x27;d update your specs as follows:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">collections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/inventory/anvils</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">/sku</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sku</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">quantity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> integer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> object</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">required</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sku</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quantity</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">materializations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">acmeCo/data-warehouse/materialize-snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">connector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/estuary/materialize</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> encrypted</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">snowflake</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.sops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> acmeCo/inventory/anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">backfill</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anvils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> inventory</span><br></span></code></pre></div></div>
<p>Note that the only change was to increment the <code>backfill</code> counter. If the previous binding spec did not specify <code>backfill</code>, then just add <code>backfill: 1</code>.</p>
<p>This works because the type is broadened, so existing values will still validate against the new schema. If this were not the case, then you&#x27;d likely need to <a href="#re-creating-a-collection" class="">re-create the whole collection</a>.</p>
<p><strong>Auto-Discovers:</strong></p>
<p>If you enabled the option to <a class="" href="/pr-preview/pr-2648/concepts/captures/#automatically-update-captures"><strong>Automatically keep schemas up to date</strong> (<code>autoDiscover</code>)</a> and selected <strong>Breaking change re-versions collections</strong> (<code>evolveIncompatibleCollections</code>) for the capture, this evolution would be performed automatically.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="a-field-was-removed">A field was removed<a href="#a-field-was-removed" class="hash-link" aria-label="Direct link to A field was removed" title="Direct link to A field was removed" translate="no">​</a></h3>
<p><em>Scenario: this is one way in which the schema can change.</em></p>
<p>Removing fields is generally allowed by all connectors, and does not require new tables or collections. Note that for database materializations, the existing column will <em>not</em> be dropped, and will just be ignored by the materialization going forward. A <code>NOT NULL</code> constraint would be removed from that column, but it will otherwise be left in place.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-schema-evolution-works">How schema evolution works<a href="#how-schema-evolution-works" class="hash-link" aria-label="Direct link to How schema evolution works" title="Direct link to How schema evolution works" translate="no">​</a></h2>
<p>Understanding how Estuary handles schemas helps you troubleshoot issues and make informed decisions about backfills.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="write-schemas-vs-read-schemas">Write schemas vs. read schemas<a href="#write-schemas-vs-read-schemas" class="hash-link" aria-label="Direct link to Write schemas vs. read schemas" title="Direct link to Write schemas vs. read schemas" translate="no">​</a></h3>
<p>Collections maintain two separate schemas:</p>
<ul>
<li class=""><strong>Write schema</strong>: Constrains new documents coming from captures and derivations</li>
<li class=""><strong>Read schema</strong>: Validates existing documents when they&#x27;re consumed by materializations</li>
</ul>
<p>These operate independently. When a capture discovers a schema change, it updates the write schema for new documents. Existing documents in the collection were written under older schemas and remain valid under the read schema.</p>
<p>This separation is why new columns show <code>NULL</code> for historical data—those documents were captured before the column existed.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="auto-inference-only-widens">Auto-inference only widens<a href="#auto-inference-only-widens" class="hash-link" aria-label="Direct link to Auto-inference only widens" title="Direct link to Auto-inference only widens" translate="no">​</a></h3>
<p>Estuary&#x27;s schema inference creates &quot;shrink-wrap&quot; schemas that accommodate all document variations seen so far. Importantly, <strong>inference only widens schemas, never narrows them</strong>.</p>
<p><strong>Compatible changes (collection level):</strong></p>
<ul>
<li class="">Adding a new field</li>
<li class="">Changing <code>required</code> to optional</li>
<li class="">Widening types (e.g., <code>integer</code> to <code>number</code>)</li>
</ul>
<p><strong>Incompatible changes (require backfill):</strong></p>
<ul>
<li class="">Narrowing types (e.g., <code>string</code> to <code>integer</code>)</li>
<li class="">Adding a <code>required</code> constraint</li>
<li class="">Changing key pointers or partitioning</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Even when a change is compatible at the collection level, your destination connector may require a backfill to alter the table schema. For example, widening <code>integer</code> to <code>bigint</code> is compatible in the collection, but some databases need a backfill to apply the column type change.</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>For a deep dive into the architecture of schema evolution, see <a href="https://github.com/estuary/flow/discussions/1988" target="_blank" rel="noopener noreferrer" class="">Discussion #1988: Collection Evolution and Source-Defined Schema</a>.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-are-my-new-columns-showing-null-values">Why are my new columns showing NULL values?<a href="#why-are-my-new-columns-showing-null-values" class="hash-link" aria-label="Direct link to Why are my new columns showing NULL values?" title="Direct link to Why are my new columns showing NULL values?" translate="no">​</a></h3>
<p>When you add a new column to a source table, existing documents in Estuary collections were captured <em>before</em> that column existed. The new column will only have values for documents captured <em>after</em> the schema change.</p>
<p><strong>Example:</strong></p>
<ol>
<li class="">You add column <code>is_active</code> to your source table</li>
<li class="">Estuary detects the change and updates the collection schema</li>
<li class="">New documents include <code>is_active</code>, but historical documents don&#x27;t have it</li>
<li class="">When materialized, historical rows show <code>NULL</code> for <code>is_active</code></li>
</ol>
<p><strong>Solution:</strong> Trigger a backfill to recapture historical data with the new schema.</p>
<ul>
<li class=""><strong>UI</strong>: Go to your capture → Click <strong>Backfill</strong> on the affected binding</li>
<li class=""><strong>flowctl</strong>: Increment the <code>backfill</code> counter in your capture spec and republish</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>For very large tables, consider whether you need historical values for the new column, or if <code>NULL</code> for older records is acceptable.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="my-data-stopped-flowing-after-a-schema-change">My data stopped flowing after a schema change<a href="#my-data-stopped-flowing-after-a-schema-change" class="hash-link" aria-label="Direct link to My data stopped flowing after a schema change" title="Direct link to My data stopped flowing after a schema change" translate="no">​</a></h3>
<p>If data stops flowing after a schema change at your source, work through these checks:</p>
<ol>
<li class="">
<p><strong>Is the capture running?</strong></p>
<ul>
<li class="">Check the hourly data graph and logs in the UI</li>
<li class="">Most schema changes (like adding columns) are handled automatically—the capture briefly restarts to pick up the new schema</li>
</ul>
</li>
<li class="">
<p><strong>Is the materialization running?</strong></p>
<ul>
<li class="">Check the hourly data graph and logs in the UI</li>
<li class="">If stopped, look for schema validation errors in the logs</li>
</ul>
</li>
<li class="">
<p><strong>Did you see a &quot;Changes rejected&quot; prompt?</strong></p>
<ul>
<li class="">When schema changes would break downstream tasks, the UI shows: <em>&quot;Changes rejected due to incompatible collection updates&quot;</em></li>
<li class="">Click <strong>Apply</strong> to automatically update downstream tasks (this may trigger backfills)</li>
</ul>
</li>
</ol>
<p><strong>Common causes and solutions:</strong></p>
<table><thead><tr><th>Symptom</th><th>Likely Cause</th><th>Solution</th></tr></thead><tbody><tr><td>Transient &quot;document failed validation&quot; error</td><td>Schema inference racing with new records</td><td>See <a href="#transient-validation-errors-during-schema-changes" class="">Transient validation errors</a> section below</td></tr><tr><td>&quot;Changes rejected due to incompatible collection updates&quot;</td><td>Incompatible schema change detected</td><td>Click <strong>Apply</strong> to update downstream tasks</td></tr><tr><td>&quot;Unsupported operation DROP TABLE&quot;</td><td>Destructive DDL change</td><td>Disable capture, remove binding, re-enable</td></tr><tr><td>Data flows but destination unchanged</td><td>Processing delay or materialization paused</td><td>Check task status in UI</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="transient-validation-errors-during-schema-changes">Transient validation errors during schema changes<a href="#transient-validation-errors-during-schema-changes" class="hash-link" aria-label="Direct link to Transient validation errors during schema changes" title="Direct link to Transient validation errors during schema changes" translate="no">​</a></h3>
<p>When your source data changes shape, you may see errors like:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">document failed validation against its collection JSON Schema</span><br></span></code></pre></div></div>
<p><strong>Why this happens:</strong></p>
<p>Schema updates and new data records are processed through separate paths. When a source schema changes:</p>
<ol>
<li class="">The capture detects the change and publishes an updated collection schema</li>
<li class="">New records (with the new shape) start flowing immediately</li>
<li class="">The materialization receives these new records</li>
<li class="">If a record arrives <em>before</em> the schema update is applied, validation fails</li>
</ol>
<p>This is a side effect of a low-latency system—we don&#x27;t artificially delay records, so the schema change can arrive slightly after the first records with the new shape. The system is designed to recover automatically.</p>
<p><strong>How to identify transient vs. persistent failures:</strong></p>
<table><thead><tr><th>Indicator</th><th>Transient (wait)</th><th>Persistent (action needed)</th></tr></thead><tbody><tr><td>Timing</td><td>Started during/after a source schema change</td><td>No recent schema changes</td></tr><tr><td>Duration</td><td>Resolves within 5-10 minutes</td><td>Persists beyond 30 minutes</td></tr><tr><td>Error pattern</td><td>Intermittent, then stops</td><td>Continuous, every record fails</td></tr><tr><td>Materialization status</td><td>Restarts automatically</td><td>Stays failed or loops</td></tr></tbody></table>
<p><strong>What happens during recovery:</strong></p>
<ol>
<li class="">The materialization encounters validation errors and restarts</li>
<li class="">On restart, it picks up the updated collection schema</li>
<li class="">Processing resumes normally with the new schema</li>
<li class="">No data is lost—failed records are retried after the schema update</li>
</ol>
<p><strong>When to take action:</strong></p>
<ul>
<li class=""><strong>Wait 15-30 minutes</strong> before investigating further</li>
<li class=""><strong>Check the logs</strong> for the specific validation error—if it references a field that was just added/changed, it&#x27;s likely transient</li>
<li class=""><strong>If errors persist</strong>, verify your source schema change was compatible (see <a href="#auto-inference-only-widens" class="">Auto-inference only widens</a> above)</li>
<li class=""><strong>If you made an incompatible change</strong>, you may need to trigger a backfill or adjust your schema</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>High-volume sources with frequent schema changes may see these transient errors more often. If this becomes disruptive, consider batching schema changes during low-traffic periods.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuring-automatic-schema-change-handling">Configuring automatic schema change handling<a href="#configuring-automatic-schema-change-handling" class="hash-link" aria-label="Direct link to Configuring automatic schema change handling" title="Direct link to Configuring automatic schema change handling" translate="no">​</a></h3>
<p>You can configure how materializations respond to incompatible schema changes using the <code>onIncompatibleSchemaChange</code> setting.</p>
<p><strong>In the Flow web app:</strong></p>
<ol>
<li class="">Edit your materialization</li>
<li class="">Go to <strong>Collections</strong></li>
<li class="">Click <strong>Config</strong> on a collection</li>
<li class="">Expand <strong>Advanced Options</strong></li>
<li class="">Set <strong>Incompatible Schema Change</strong> to your preferred action</li>
</ol>
<p><strong>Available options:</strong></p>
<table><thead><tr><th>Option</th><th>Behavior</th></tr></thead><tbody><tr><td><strong>backfill</strong> <em>(default)</em></td><td>Automatically backfill and re-materialize the affected binding</td></tr><tr><td><strong>abort</strong></td><td>Fail the publication, preventing incompatible changes</td></tr><tr><td><strong>disableBinding</strong></td><td>Disable only the affected binding until manually re-enabled</td></tr><tr><td><strong>disableTask</strong></td><td>Disable the entire materialization until manually re-enabled</td></tr></tbody></table>
<p><strong>Using flowctl:</strong></p>
<p>Set the field at the top level (applies to all bindings) or per-binding:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">materializations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">myPrefix/my-materialization</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">onIncompatibleSchemaChange</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> disableTask  </span><span class="token comment" style="color:#999988;font-style:italic"># or: backfill (default), abort, disableBinding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">bindings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myPrefix/my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">onIncompatibleSchemaChange</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> abort  </span><span class="token comment" style="color:#999988;font-style:italic"># Override for this binding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my_table</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>These behaviors only trigger during automated actions like AutoDiscover. Manual changes via the UI will prompt you to choose an action.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="type-inference-issues-with-nosql-sources">Type inference issues with NoSQL sources<a href="#type-inference-issues-with-nosql-sources" class="hash-link" aria-label="Direct link to Type inference issues with NoSQL sources" title="Direct link to Type inference issues with NoSQL sources" translate="no">​</a></h3>
<p>NoSQL databases like MongoDB allow flexible schemas where the same field can have different types across documents. Estuary infers a schema based on the data it observes, which can lead to unexpected type widening.</p>
<p><strong>Common issue:</strong> &quot;My date field is being stored as a string&quot;</p>
<p><strong>Why this happens:</strong></p>
<ol>
<li class="">The first documents captured had the field as a string value (e.g., <code>&quot;2024-01-15&quot;</code>)</li>
<li class="">Estuary inferred the type as <code>string</code></li>
<li class="">Later documents with proper Date types are converted to strings to match the inferred schema</li>
</ol>
<p>Remember: auto-inference only widens, never narrows. Once a field is inferred as <code>string</code>, it won&#x27;t narrow to <code>date</code>—even if all subsequent documents use the correct type.</p>
<p><strong>Options:</strong></p>
<ol>
<li class="">
<p><strong>Accept the widened type</strong>: In many cases, the widened type works fine downstream. String dates can still be parsed by your destination or BI tools. Evaluate whether this actually causes problems before investing effort in a fix.</p>
</li>
<li class="">
<p><strong>Fix at the source, then backfill</strong>: The cleanest solution when the type matters:</p>
<ul>
<li class="">Correct the inconsistent data types in your source database</li>
<li class="">Trigger a <a class="" href="/pr-preview/pr-2648/reference/backfilling-data/#dataflow-reset">dataflow reset</a> to re-infer the schema from scratch</li>
<li class="">The backfill recaptures all data with consistent types, and the schema is re-inferred correctly</li>
</ul>
</li>
<li class="">
<p><strong>Use a derivation</strong> <em>(last resort)</em>: If you can&#x27;t fix the source data, create a derivation to transform the field:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PARSE_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%Y-%m-%dT%H:%M:%S&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> created_at</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> source_collection</span><br></span></code></pre></div></div>
<p>This adds complexity to your pipeline, so only use this when options 1 and 2 aren&#x27;t viable.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>When setting up captures from schema-flexible sources, review the inferred schema before creating materializations. If types look incorrect, fix the source data and backfill <em>before</em> proceeding—it&#x27;s much easier to get the schema right from the start.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="schema-not-yet-available-for-new-collections">Schema not yet available for new collections<a href="#schema-not-yet-available-for-new-collections" class="hash-link" aria-label="Direct link to Schema not yet available for new collections" title="Direct link to Schema not yet available for new collections" translate="no">​</a></h3>
<p>When creating a materialization for a newly captured collection, you may see:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Schema not yet available for collection &#x27;{collection}&#x27;</span><br></span></code></pre></div></div>
<p><strong>Why this happens:</strong></p>
<p>Schema inference requires data to flow through the capture before it can determine the schema. For new captures:</p>
<ol>
<li class="">The capture starts and begins reading from the source</li>
<li class="">Documents are captured and schema inference analyzes them</li>
<li class="">The inferred schema is published to the collection</li>
<li class="">Only then can materializations validate against the schema</li>
</ol>
<p><strong>Solution:</strong></p>
<ol>
<li class=""><strong>Wait 5-10 minutes</strong> for the capture to process initial documents</li>
<li class=""><strong>Check capture logs</strong> to confirm data is flowing</li>
<li class=""><strong>Re-publish the materialization</strong> to pick up the inferred schema</li>
</ol>
<p>If the issue persists after 30 minutes:</p>
<ul>
<li class="">Verify your source has data to capture</li>
<li class="">Check capture logs for connection or permission errors</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="binding-not-found">Binding not found<a href="#binding-not-found" class="hash-link" aria-label="Direct link to Binding not found" title="Direct link to Binding not found" translate="no">​</a></h3>
<p>When editing or publishing a capture, you may see:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Binding not found for &#x27;{binding_name}&#x27;</span><br></span></code></pre></div></div>
<p><strong>Common causes:</strong></p>
<ol>
<li class="">
<p><strong>Source table was renamed or deleted</strong></p>
<ul>
<li class="">Check if the table still exists in your source system</li>
<li class="">If renamed, remove the old binding and add the new table name</li>
</ul>
</li>
<li class="">
<p><strong>Insufficient permissions</strong></p>
<ul>
<li class="">Verify the capture&#x27;s credentials have access to the table</li>
<li class="">For databases, check SELECT permissions on the specific table/schema</li>
</ul>
</li>
<li class="">
<p><strong>Table not yet discovered</strong></p>
<ul>
<li class="">Click <strong>Refresh</strong> on your capture to re-run discovery</li>
<li class="">New tables may take a few minutes to appear</li>
</ul>
</li>
<li class="">
<p><strong>Case sensitivity</strong></p>
<ul>
<li class="">Some databases are case-sensitive for table names</li>
<li class="">Ensure the binding name matches the exact table name</li>
</ul>
</li>
</ol>
<p><strong>To resolve:</strong></p>
<ol>
<li class="">Go to your capture and click <strong>Edit</strong></li>
<li class="">Click <strong>Refresh</strong> to re-discover available tables</li>
<li class="">If the table appears, re-add it as a binding</li>
<li class="">If not, check source permissions and table existence</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="unsupported-ddl-operations-mysqlmariadb-cdc">Unsupported DDL operations (MySQL/MariaDB CDC)<a href="#unsupported-ddl-operations-mysqlmariadb-cdc" class="hash-link" aria-label="Direct link to Unsupported DDL operations (MySQL/MariaDB CDC)" title="Direct link to Unsupported DDL operations (MySQL/MariaDB CDC)" translate="no">​</a></h3>
<p>MySQL and MariaDB CDC captures read changes from the binary log. Certain DDL operations cannot be processed from the binlog:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Unsupported operation ALTER TABLE for table &#x27;{table_name}&#x27;</span><br></span></code></pre></div></div>
<p><strong>Why this happens:</strong></p>
<p>The binary log contains row-level changes, but some DDL operations (like <code>ALTER TABLE</code>) don&#x27;t include enough information to reconstruct the new schema. When the capture encounters these, it cannot continue processing that table.</p>
<p><strong>Solution - Remove and re-add the binding:</strong></p>
<ol>
<li class=""><strong>Edit your capture</strong> and remove the affected table binding</li>
<li class=""><strong>Save and publish</strong> - this preserves other bindings</li>
<li class=""><strong>Edit again</strong> and re-add the table binding</li>
<li class=""><strong>Trigger a backfill</strong> on the materialization for this table</li>
</ol>
<p>This resets the CDC position for only this table. Other tables continue from their current position.</p>
<p><strong>To avoid this issue:</strong></p>
<ul>
<li class="">Use <code>pt-online-schema-change</code> or <code>gh-ost</code> for schema migrations (these use row-based operations)</li>
<li class="">Or temporarily pause the capture before DDL operations</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This only affects MySQL/MariaDB CDC captures. PostgreSQL and SQL Server handle DDL differently.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/estuary/flow/edit/master/site/docs/guides/schema-evolution.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/pr-preview/pr-2648/guides/how_to_generate_refresh_token/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to Generate an Estuary Refresh Token</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pr-preview/pr-2648/guides/dbt-integration/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">dbt Cloud Integration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#schema-evolution-scenarios" class="table-of-contents__link toc-highlight">Schema evolution scenarios</a><ul><li><a href="#re-creating-a-collection" class="table-of-contents__link toc-highlight">Re-creating a collection</a></li><li><a href="#a-new-field-is-added" class="table-of-contents__link toc-highlight">A new field is added</a></li><li><a href="#a-fields-data-type-has-changed" class="table-of-contents__link toc-highlight">A field&#39;s data type has changed</a></li><li><a href="#a-field-was-removed" class="table-of-contents__link toc-highlight">A field was removed</a></li></ul></li><li><a href="#how-schema-evolution-works" class="table-of-contents__link toc-highlight">How schema evolution works</a><ul><li><a href="#write-schemas-vs-read-schemas" class="table-of-contents__link toc-highlight">Write schemas vs. read schemas</a></li><li><a href="#auto-inference-only-widens" class="table-of-contents__link toc-highlight">Auto-inference only widens</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#why-are-my-new-columns-showing-null-values" class="table-of-contents__link toc-highlight">Why are my new columns showing NULL values?</a></li><li><a href="#my-data-stopped-flowing-after-a-schema-change" class="table-of-contents__link toc-highlight">My data stopped flowing after a schema change</a></li><li><a href="#transient-validation-errors-during-schema-changes" class="table-of-contents__link toc-highlight">Transient validation errors during schema changes</a></li><li><a href="#configuring-automatic-schema-change-handling" class="table-of-contents__link toc-highlight">Configuring automatic schema change handling</a></li><li><a href="#type-inference-issues-with-nosql-sources" class="table-of-contents__link toc-highlight">Type inference issues with NoSQL sources</a></li><li><a href="#schema-not-yet-available-for-new-collections" class="table-of-contents__link toc-highlight">Schema not yet available for new collections</a></li><li><a href="#binding-not-found" class="table-of-contents__link toc-highlight">Binding not found</a></li><li><a href="#unsupported-ddl-operations-mysqlmariadb-cdc" class="table-of-contents__link toc-highlight">Unsupported DDL operations (MySQL/MariaDB CDC)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pr-preview/pr-2648/">Platform Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/pr-preview/pr-2648/reference/Connectors/">Connector Docs</a></li><li class="footer__item"><a href="https://estuary.dev/success-stories/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Success Stories<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://go.estuary.dev/slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/estuary-tech/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/EstuaryDev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/estuary/flow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@estuarydev" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://estuary.dev/contact-us/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Estuary Technologies, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
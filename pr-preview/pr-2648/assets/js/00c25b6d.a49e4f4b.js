"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[1943],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var s=i(96540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}},53599:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"features/custom-column-types","title":"Custom Column Types","description":"Estuary automatically maps collection fields to appropriate column types in your destination. However, some scenarios require overriding these defaults. The castToString and DDL field configurations give you precise control over how individual fields are materialized.","source":"@site/docs/features/custom-column-types.md","sourceDirName":"features","slug":"/features/custom-column-types","permalink":"/pr-preview/pr-2648/features/custom-column-types","draft":false,"unlisted":false,"editUrl":"https://github.com/estuary/flow/edit/master/site/docs/features/custom-column-types.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Working with Logs and Statistics","permalink":"/pr-preview/pr-2648/reference/working-logs-stats/"},"next":{"title":"Feature Flags","permalink":"/pr-preview/pr-2648/features/feature-flags"}}');var t=i(74848),r=i(28453);const l={},o="Custom Column Types",c={},d=[{value:"When to Use Custom Column Types",id:"when-to-use-custom-column-types",level:2},{value:"Configuration",id:"configuration",level:2},{value:"castToString",id:"casttostring",level:3},{value:"DDL",id:"ddl",level:3},{value:"Combining Options",id:"combining-options",level:2},{value:"Configuring via the Web App",id:"configuring-via-the-web-app",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Column type mismatch errors",id:"column-type-mismatch-errors",level:3},{value:"Invalid DDL errors",id:"invalid-ddl-errors",level:3},{value:"Data truncation",id:"data-truncation",level:3},{value:"Related",id:"related",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"custom-column-types",children:"Custom Column Types"})}),"\n",(0,t.jsxs)(n.p,{children:["Estuary automatically maps collection fields to appropriate column types in your destination. However, some scenarios require overriding these defaults. The ",(0,t.jsx)(n.code,{children:"castToString"})," and ",(0,t.jsx)(n.code,{children:"DDL"})," field configurations give you precise control over how individual fields are materialized."]}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use-custom-column-types",children:"When to Use Custom Column Types"}),"\n",(0,t.jsx)(n.p,{children:"Common scenarios include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Precision requirements"}),": Numeric fields that exceed the destination's native integer precision"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Custom database types"}),": Using destination-specific types like ",(0,t.jsx)(n.code,{children:"DECIMAL(20,5)"})," or ",(0,t.jsx)(n.code,{children:"JSONB"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"String representation"}),": Forcing fields to be stored as strings for compatibility with downstream systems"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Computed columns"}),": Advanced DDL with expressions or constraints"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Custom column types are configured per-field in the materialization's ",(0,t.jsx)(n.code,{children:"fields"})," stanza:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'materializations:\n  acmeCo/my-materialization:\n    bindings:\n      - source: acmeCo/my-collection\n        resource: { table: my_table }\n        fields:\n          recommended: true\n          include:\n            revenue: { castToString: true }\n            large_integer: { DDL: "DECIMAL(38,0)" }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"casttostring",children:"castToString"}),"\n",(0,t.jsx)(n.p,{children:"Actively converts a field's value to its string representation before writing to the destination."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"fields:\n  include:\n    myField: { castToString: true }\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Large integer IDs that exceed 64-bit precision (barcodes, external system IDs)"}),"\n",(0,t.jsx)(n.li,{children:"High-precision or nanosecond timestamps that need exact preservation"}),"\n",(0,t.jsx)(n.li,{children:"Numeric fields with values exceeding 64-bit integer range"}),"\n",(0,t.jsx)(n.li,{children:"Fields that may contain multiple types (numbers, strings, objects)"}),"\n",(0,t.jsx)(n.li,{children:"Compatibility with systems that expect string-formatted numbers"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Values are actively converted to strings: numbers \u2192 ",(0,t.jsx)(n.code,{children:'"3"'}),", booleans \u2192 ",(0,t.jsx)(n.code,{children:'"true"'}),", objects \u2192 ",(0,t.jsx)(n.code,{children:'"{\\"foo\\":\\"bar\\"}"'})]}),"\n",(0,t.jsx)(n.li,{children:"The destination column is created as a string/text type"}),"\n",(0,t.jsx)(n.li,{children:"Original type information is preserved in the collection; only the materialized representation changes"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Connector support:"})," Most SQL and warehouse materializers support ",(0,t.jsx)(n.code,{children:"castToString"}),". However, ",(0,t.jsx)(n.strong,{children:"Elasticsearch"}),", ",(0,t.jsx)(n.strong,{children:"MongoDB"}),", and ",(0,t.jsx)(n.strong,{children:"DynamoDB"})," connectors do not support this option."]}),"\n",(0,t.jsx)(n.h3,{id:"ddl",children:"DDL"}),"\n",(0,t.jsx)(n.p,{children:"Specifies custom DDL (Data Definition Language) for the column definition."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'fields:\n  include:\n    myField: { DDL: "DECIMAL(20,5)" }\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use cases:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Specifying exact numeric precision and scale"}),"\n",(0,t.jsx)(n.li,{children:"Using destination-specific column types not automatically selected"}),"\n",(0,t.jsxs)(n.li,{children:["Storing complex data as JSON (e.g., ",(0,t.jsx)(n.code,{children:"JSON"})," in BigQuery, ",(0,t.jsx)(n.code,{children:"JSONB"})," in PostgreSQL)"]}),"\n",(0,t.jsx)(n.li,{children:"Adding column constraints or defaults"}),"\n",(0,t.jsx)(n.li,{children:"Creating computed or generated columns (where supported)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Behavior:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The provided DDL string replaces the automatically generated column type"}),"\n",(0,t.jsx)(n.li,{children:"The connector uses this DDL verbatim when creating or altering the column"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Important:"})," DDL only changes the column definition\u2014it does NOT transform the data. The burden is on you to ensure the field's data is compatible with the specified column type."]}),"\n",(0,t.jsx)(n.li,{children:"When you specify custom DDL, the connector disables its normal type validation for that field"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Examples by destination:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Destination"}),(0,t.jsx)(n.th,{children:"Example DDL"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PostgreSQL"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"NUMERIC(38,10)"})}),(0,t.jsx)(n.td,{children:"High-precision decimal"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PostgreSQL"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"JSONB"})}),(0,t.jsx)(n.td,{children:"Binary JSON storage"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Snowflake"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"NUMBER(14,6)"})}),(0,t.jsx)(n.td,{children:"Decimal with specific precision"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"BigQuery"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"BIGNUMERIC"})}),(0,t.jsx)(n.td,{children:"Arbitrary precision decimal"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"BigQuery"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"JSON"})}),(0,t.jsx)(n.td,{children:"Native JSON column type"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"MySQL"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DECIMAL(65,30)"})}),(0,t.jsx)(n.td,{children:"Maximum precision decimal"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Connector support:"})," DDL is supported by most SQL and warehouse materializers. The ",(0,t.jsx)(n.strong,{children:"Iceberg"})," connector does not support DDL; use the ",(0,t.jsx)(n.code,{children:"ignoreStringFormat"})," option instead for similar functionality."]}),"\n",(0,t.jsx)(n.h2,{id:"combining-options",children:"Combining Options"}),"\n",(0,t.jsxs)(n.p,{children:["You can use ",(0,t.jsx)(n.code,{children:"castToString"})," and ",(0,t.jsx)(n.code,{children:"DDL"})," together, though this is rarely needed:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'fields:\n  include:\n    myField: { castToString: true, DDL: "VARCHAR(100)" }\n'})}),"\n",(0,t.jsx)(n.p,{children:"When combined:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The value is first converted to a string"}),"\n",(0,t.jsx)(n.li,{children:"The string is stored in a column with your custom DDL"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"configuring-via-the-web-app",children:"Configuring via the Web App"}),"\n",(0,t.jsx)(n.p,{children:"You can also configure these options through Estuary's web application:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Navigate to your materialization and click ",(0,t.jsx)(n.strong,{children:"Edit"})]}),"\n",(0,t.jsx)(n.li,{children:"Select the binding you want to modify"}),"\n",(0,t.jsxs)(n.li,{children:["In the ",(0,t.jsx)(n.strong,{children:"Field Selection"})," table, find the field you want to customize"]}),"\n",(0,t.jsx)(n.li,{children:"Click the field's configuration button to access advanced options"}),"\n",(0,t.jsxs)(n.li,{children:["Set ",(0,t.jsx)(n.code,{children:"castToString"})," or provide custom ",(0,t.jsx)(n.code,{children:"DDL"})," as needed"]}),"\n",(0,t.jsxs)(n.li,{children:["Click ",(0,t.jsx)(n.strong,{children:"Save and Publish"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"column-type-mismatch-errors",children:"Column type mismatch errors"}),"\n",(0,t.jsx)(n.p,{children:"If you change the DDL for an existing column, the connector may report a type mismatch. Options:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Backfill the binding"}),": This recreates the table with the new column type"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Manually alter the column"}),": Use your destination's tools to modify the column type, then republish"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"invalid-ddl-errors",children:"Invalid DDL errors"}),"\n",(0,t.jsx)(n.p,{children:"If your custom DDL is invalid for the destination:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Check the destination's documentation for valid column type syntax"}),"\n",(0,t.jsx)(n.li,{children:"Ensure any referenced types or constraints exist in your destination"}),"\n",(0,t.jsx)(n.li,{children:"Test the DDL manually in your destination before applying"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"data-truncation",children:"Data truncation"}),"\n",(0,t.jsxs)(n.p,{children:["When using ",(0,t.jsx)(n.code,{children:"castToString"})," with ",(0,t.jsx)(n.code,{children:"DDL"})," that limits string length:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Ensure your DDL length accommodates the longest possible string representation"}),"\n",(0,t.jsxs)(n.li,{children:["Consider using unlimited length types like ",(0,t.jsx)(n.code,{children:"TEXT"})," if unsure"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/guides/customize-materialization-fields/",children:"Customize Materialized Fields"})," - Field selection basics"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/features/feature-flags",children:"Feature Flags"})," - Additional connector configuration options"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);
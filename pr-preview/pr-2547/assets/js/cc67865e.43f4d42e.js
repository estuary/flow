"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[7840],{25009:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"security/redaction","title":"Redaction","description":"Redaction is a security feature in Estuary that allows you to block or hash fields from a capture during write time, before documents are fully captured.","source":"@site/docs/security/redaction.md","sourceDirName":"security","slug":"/security/redaction","permalink":"/pr-preview/pr-2547/security/redaction","draft":false,"unlisted":false,"editUrl":"https://github.com/estuary/flow/edit/master/site/docs/security/redaction.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Allowlisting IP Addresses for Estuary Flow","permalink":"/pr-preview/pr-2547/reference/allow-ip-addresses/"}}');var t=i(74848),r=i(28453);const o={},a="Redaction",c={},l=[{value:"Redaction Strategies",id:"redaction-strategies",level:2},{value:"How to Use Redaction",id:"how-to-use-redaction",level:2},{value:"Redacting properties in specification files",id:"redacting-properties-in-specification-files",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"redaction",children:"Redaction"})}),"\n",(0,t.jsxs)(n.p,{children:["Redaction is a security feature in Estuary that allows you to block or hash fields from a capture during write time, ",(0,t.jsx)(n.em,{children:"before"})," documents are fully captured.\nAdding redaction prevents fields or unhashed values from being written to disk or surfacing in error messages."]}),"\n",(0,t.jsxs)(n.p,{children:["Essentially, it is the earliest point in Estuary when you can remove fields, compared against other options like ",(0,t.jsx)(n.a,{href:"/concepts/derivations",children:"derivations"})," and customizing materialization schemas with ",(0,t.jsx)(n.a,{href:"/guides/customize-materialization-fields/#field-selection-for-materializations",children:"field selection"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"This makes it an essential tool when working with PII or other sensitive data."}),"\n",(0,t.jsx)(n.h2,{id:"redaction-strategies",children:"Redaction Strategies"}),"\n",(0,t.jsxs)(n.p,{children:["Estuary lets you choose how you would like to handle redacted fields with different ",(0,t.jsx)(n.em,{children:"redaction strategies"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Redaction strategies include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Block"})}),"\n",(0,t.jsx)(n.p,{children:"Removes fields entirely from documents."}),"\n",(0,t.jsx)(n.p,{children:"Blocking fields is useful when none of your downstream systems need to access any information about the field or its value."}),"\n",(0,t.jsx)(n.p,{children:"For example, completely removing a field containing a user SSN (which ideally should already be encrypted in the source system to begin with)."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hash"})}),"\n",(0,t.jsx)(n.p,{children:"Replaces values with SHA-256 hashed versions of the values."}),"\n",(0,t.jsx)(n.p,{children:"Hashing fields can be useful when you would like to include stand-in values for sensitive fields in downstream systems but don't want those systems or system users to have access to the unhashed value."}),"\n",(0,t.jsx)(n.p,{children:"For example, hashing a user email so analysts can still compile information about a user journey without seeing the user's PII."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-use-redaction",children:"How to Use Redaction"}),"\n",(0,t.jsxs)(n.p,{children:["You can redact fields using Estuary's web application. Redaction is surfaced as part of the ",(0,t.jsx)(n.a,{href:"/concepts/captures",children:"capture"})," process."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Start by creating a new capture or editing an existing one."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Target Collections"})," section of the capture configuration, find the ",(0,t.jsx)(n.strong,{children:"Bindings"})," table."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Select a binding whose fields you would like to edit."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["On the right-hand side of the table, select the binding's ",(0,t.jsx)(n.strong,{children:"Collection"})," tab."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Review the ",(0,t.jsx)(n.strong,{children:"Schema"})," table. The table provides all available fields and their types, along with an ",(0,t.jsx)(n.strong,{children:"Actions"})," column."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Click the ",(0,t.jsx)(n.strong,{children:"Redact"})," button in the Actions column for any field you would like to redact."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Select your desired ",(0,t.jsx)(n.a,{href:"#redaction-strategies",children:"redaction strategy"})," and click ",(0,t.jsx)(n.strong,{children:"Apply"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Redacted fields will display a lock icon next to the field name.\nHovering over the lock will indicate which redaction strategy applies to the field."}),"\n",(0,t.jsx)(n.h3,{id:"redacting-properties-in-specification-files",children:"Redacting properties in specification files"}),"\n",(0,t.jsxs)(n.p,{children:["Estuary handles redaction via JSON schema annotations.\nWhen managing Estuary resources directly via their specification files, you can therefore redact fields using ",(0,t.jsx)(n.code,{children:"redact"})," annotations."]}),"\n",(0,t.jsxs)(n.p,{children:["To avoid conflicts with schema inference and discovery, however, these annotations must be applied to properties at the ",(0,t.jsx)(n.em,{children:"top level"})," of the write schema, outside the connector or inferred schema."]}),"\n",(0,t.jsxs)(n.p,{children:["Properties in this top-level write schema can include a ",(0,t.jsx)(n.code,{children:"redact"})," annotation with a valid ",(0,t.jsx)(n.a,{href:"#redaction-strategies",children:(0,t.jsx)(n.code,{children:"strategy"})}),": either ",(0,t.jsx)(n.code,{children:"block"})," or ",(0,t.jsx)(n.code,{children:"sha256"})," for hashing.\nYou do not need to include top-level properties for all collection fields, only ones you wish to annotate."]}),"\n",(0,t.jsx)(n.p,{children:"An example collection specification would therefore look like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "writeSchema": {\n    "$defs": {\n      "flow://connector-schema": {...}\n    },\n    "$ref": "flow://connector-schema",\n    "properties": {\n      "ssn": {\n        "redact": {\n          "strategy": "block"\n        }\n      },\n      "email": {\n        "redact": {\n          "strategy": "sha256"\n        }\n      }\n    }\n  },\n  "readSchema": {...}\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var s=i(96540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);